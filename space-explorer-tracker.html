<html><!--

v.5.2.0test
 - la chiamata all'API non funziona piu', sistemare
 - test url : ?orbiter=-98&center=@499&start=2018-9-26%2013:00&stop=2022-9-27%2012:00&step=30d
 
 
v. 5.1.0:
 - Sistemato autorange grafico 2d

v. 5.0.0:
 - Implementata nuova API
 - Implementato plotting in tempo reale

v. 4.12.0:
 - Zoom 3d automatico a 2 volte la massima altezza/distanza
 - Risolto bug di etichette asse X tagliate (layout margin)
 - Risolto bug di etichetta principale pagina contenente "missing parameter name"
 - Aggiunta opzione per regolazione manuale zoom 3d
 - Aggiunti pulsanti per regolazione zoom 2d
 - Aggiunta predisposizione per cambio server Horizon (a settembre 2021 hanno introdotto nuova API con nuovo indirizzo. v. https://ssd-api.jpl.nasa.gov/obsolete/horizons_batch_cgi.html)
 - Aggiunta predisposizione per rimuovere proxy php (in locale serve ancora, da server boh)
 - Migliorata visualizzazione pallino che rappresenta oggi
 - Rimosso SVG di MARS2020 memorizzato per errore (forse salvato per sbaglio da versione online...)
 - Migliorata intercettazione errori, migliorati messaggi di errore sia in console che in pagina

v. 4.11.1 - Sistemato bug di bodyname
v. 4.11.0 - Implementato mio sistema CORS
v. 4.10.0 - Implementato timestep senza unità di misura; aggiunte varie sonde a quelle riconosciute; risolto bug di raggio specificato dall'utente non effettivamente usto.
			   Aggiunti link precompilati per vari EDL su Marte.
v. 4.9.0 - Ottimizzate etichette 3d, messo autozoom 2d, corretto bug di altezza non disponibile se raggio non disponibile.
v. 4.8.0 - Eliminati tooltip di hovering per sfera pianeta; aggiunto indicatore di posizione nell'array in tooltip traccia 3d; eliminati pulsanti zoom2d.
v. 4.7.2 - Inizio ad aggiungere tracciamento di traccia aggiuntiva tramite variabile CALLER, ma per ora non funziona...
v. 4.7.1 - Risolto bug di timestep di url non mostrato in casella; risolto bug di mancanza marker posizione odierna in 3d e 2d
// Da fare:
// gestione di qualunque messaggio di errore della NASA, non solo alcuni
// aggiungere come textbox tutti i parametri già possibili in url
// aggiungere possibilità di tracce multiple da URL gia noti (da copiare in textbox)

v.4.7  - Aggiunto zoom 3d (anche da url; aggiungere pulsante/slider)
v. 4.6 - Aggiungo tabella copiabile direttamente in excel italiano; aggiunte funzioni per zoom 3d manuale (per ora non accessibili a utente9
v.4.5	Aggiunta mesh di corpo centrale sferico; corretto bug di sole non supportato come centro di rotazione; **hayabusa non funziona rispetto a ryugu*** 	
v.4.4
Aggiunto supporto per data inizio, data fine e timestep in URL (start,stop,step)
Reso più robusto algoritmo di ricerca delle date disponibili (il file di input cambia formato a piacere....)
v. 4.3 - Forse scritto algoritmo valido per estrarre date disponibili da qualsiasi file...
v. 4.2 - Aggiungo link per "corsa a Marte": "Hope" degli Emirati Arabi, "Tianwen-1" (Giappone) e "Perseverance+Ingenuity" (USA)
v. 4.1 - Corretto bug stringa titolo per oggetti non noti, e bug di usare sempre Marte @499; separate date-dati e date-grafico.
V. 4.0 - Rivista completamente gestione parametri; aggiunta possibilità di specifiare punto su corpo celeste
V. 3.2 - Corretto bug che impediva tracciamento di oggetti non in archivio ma presenti su NASA Horizons
V. 3.1 - Corretto bug di mancata assegnazione raggio corrispondente a corpo celeste selezionato (bodyRadius)
V. 3.0 - Versione universale
V. 2.0 - Versione modificata per Chandrayaan 2
V. 1.3 - Aggiunto progresso di download; risolto bug grafico "strizzato" in chrome: larghezza fissa invece che %
V. 1.2 - Aggiunta linea tratteggiata per grafico 2d futuro
V. 1.1 - 2019-08-23:
         Grafico 2d rispetto al suolo invece che rispetto al centro di grravita'.
		 Aggiunto pallino posizione in grafico 2d.
		 Aggiunta etichetta mancante in pallino posizione odierna.
		 Data iniziale ora è quella odierna.
		 Aggiunta possibilità di specificare time-step.
V. 1.0 - 2019-08-22 - Derivata da 2.0 Osiris; plot.ly scaricato da remoto
-->
<head>
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/pace-theme-default.min.css">

<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<!-- Plotly.js -->

<!-- https://cdn.plot.ly/plotly-latest.min.js -->
	<script src="js/plotly-latest.min.js"></script>
	<style id="plotly.js-style-global"></style>
	<script src="js/jquery.js"></script>
	<style id="plotly.js-style-modebar-02919b"></style>
	<style id="plotly.js-style-modebar-64a342"></style>
	</head>
	
	<body>
	<script>
    previousZoomSet = false;
	marker1 = "Trajectory name";
	markerAsterisks = "\n*******************************************************************************";
	marker3 = "------";
	markerDateMAXLength = "-----------------"; // yyyy/mm/dd hh:mm  Longer sequence of dashes SHOULD mark length of filename length
	markerFileNameFieldLength =  "\n  " + markerDateMAXLength; //After new line
	MAXLEN = 80;
    MAX_TIMESTEPS = 10000; // Too many timesteps would result in too long file to download
	MSperMinute = 60000; // 
    TODAY_VISIBLE = false;
	//BASE_HORIZONS_URL = "https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1";
	BASE_HORIZONS_URL = "https://ssd.jpl.nasa.gov/api/horizons.api?format=text"; // new api setp 2021
	minDist = 1/0;
	maxDist = -1;
	LOCAL_PROXY = "https://win98.altervista.org/space/exploration/myp.php?pass=miapass&mode=native&url=";
    finalURL = "";
    intervalPlotIndex = 0; // DEBUG - data index to plot dynamically inside setInterval
    intervalPlot = null;
    orbiterNameShown = "";
    bodyNameShown = "";
    distancesArray = [];
    lineDataArray = [];
    xposArray = [];
    yposArray = [];
    zposArray = [];
    speedArray = [];

	showHelp = false; // Assignd by INIT() in case page is called without parameters

	sphereA =  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1361666490962466, 0.13111722037499746, 0.11634342723990568, 0.09294097434219462, 0.06264551455418925, 0.027703923535859376, -0.00929234075410815, -0.045599434639973825, -0.07852462706212554, -0.10562600712134525, -0.12489358943920463, -0.13489838557851214, -0.13489838557851214, -0.12489358943920467, -0.10562600712134526, -0.0785246270621256, -0.04559943463997385, -0.009292340754108213, 0.027703923535859282, 0.06264551455418917, 0.09294097434219453, 0.11634342723990568, 0.13111722037499743, 0.1361666490962466, 0.2697967711570243, 0.2597919750177168, 0.23051959656054993, 0.18415063418347083, 0.1241240617020994, 0.05489177539408203, -0.018411582781751167, -0.0903494380900486, -0.1555864888963838, -0.20928440158210024, -0.24746064761490305, -0.26728386947124405, -0.26728386947124405, -0.24746064761490313, -0.20928440158210027, -0.1555864888963839, -0.09034943809004865, -0.01841158278175129, 0.05489177539408185, 0.12412406170209925, 0.18415063418347066, 0.23051959656054993, 0.2597919750177168, 0.2697967711570243, 0.39840108984624145, 0.3836272967111497, 0.3404016219570977, 0.27192991613628953, 0.1832904124322432, 0.0810570973359405, -0.027187851858222596, -0.13341640245620756, -0.22975006882344456, -0.3090442236226754, -0.36541798213906196, -0.3946903605962289, -0.3946903605962289, -0.3654179821390621, -0.3090442236226755, -0.2297500688234447, -0.13341640245620764, -0.02718785185822278, 0.08105709733594023, 0.18329041243224298, 0.27192991613628925, 0.3404016219570977, 0.38362729671114965, 0.39840108984624145, 0.5195839500354336, 0.5003163677175742, 0.4439426092011876, 0.3546436582626493, 0.23904240957755282, 0.10571247892034828, -0.03545766269596656, -0.17399807167813505, -0.2996338396721488, -0.4030471365112869, -0.4765682710533442, -0.5147445170861471, -0.5147445170861471, -0.47656827105334437, -0.40304713651128693, -0.29963383967214896, -0.17399807167813516, -0.035457662695966806, 0.10571247892034792, 0.23904240957755252, 0.354643658262649, 0.4439426092011876, 0.5003163677175742, 0.5195839500354336, 0.6310879443260528, 0.6076854914283417, 0.5392137856075335, 0.4307510600471463, 0.29034149891804073, 0.12839863703816132, -0.0430669643661589, -0.21133848604169345, -0.36393599901675733, -0.48954204384116135, -0.5788409947796996, -0.6252099571567789, -0.6252099571567789, -0.5788409947796999, -0.4895420438411614, -0.36393599901675755, -0.21133848604169359, -0.04306696436615919, 0.1283986370381609, 0.29034149891804034, 0.43075106004714586, 0.5392137856075335, 0.6076854914283417, 0.6310879443260528, 0.730835964278124, 0.7037345842189043, 0.6244404294196735, 0.4988343845952696, 0.3362320754808981, 0.14869297148750435, -0.04987400997603559, -0.24474206427806688, -0.42145871929303796, -0.5669177091433928, -0.6703310059825308, -0.7240289186682474, -0.7240289186682474, -0.670331005982531, -0.5669177091433928, -0.42145871929303824, -0.24474206427806702, -0.04987400997603592, 0.14869297148750382, 0.3362320754808977, 0.4988343845952691, 0.6244404294196735, 0.7037345842189043, 0.730835964278124, 0.816969893010442, 0.7866744332224367, 0.6980349295183903, 0.5576253683892848, 0.37585928465306434, 0.16621743721594145, -0.05575199714530953, -0.27358656092670885, -0.4711304610594101, -0.6337327701737816, -0.7493340188588781, -0.8093605913402496, -0.8093605913402496, -0.7493340188588783, -0.6337327701737817, -0.47113046105941037, -0.2735865609267091, -0.05575199714530991, 0.1662174372159409, 0.3758592846530639, 0.5576253683892842, 0.6980349295183903, 0.7866744332224366, 0.816969893010442, 0.8878852184023752, 0.8549600259802236, 0.7586263596129864, 0.6060288466379224, 0.40848494650522105, 0.1806455865845144, -0.060591430094595986, -0.29733465759093874, -0.5120259337493107, -0.6887425887642821, -0.8143783567582958, -0.8796154075646312, -0.8796154075646312, -0.8143783567582961, -0.6887425887642822, -0.512025933749311, -0.29733465759093897, -0.060591430094596395, 0.1806455865845138, 0.40848494650522055, 0.6060288466379218, 0.7586263596129864, 0.8549600259802235, 0.8878852184023752, 0.9422609221188205, 0.9073193311004907, 0.8050860160041878, 0.6431431541243084, 0.4335013066871854, 0.19170865046959368, -0.06430215934460852, -0.31554397216302643, -0.543383332083733, -0.7309224360771269, -0.8642523667343315, -0.9334846530423491, -0.9334846530423491, -0.8642523667343318, -0.730922436077127, -0.5433833320837334, -0.3155439721630266, -0.06430215934460895, 0.191708650469593, 0.43350130668718484, 0.6431431541243078, 0.8050860160041878, 0.9073193311004906, 0.9422609221188205, 0.9790840876823228, 0.9427769937964572, 0.8365484431984722, 0.6682769215229378, 0.4504423577415385, 0.1992005449231209, -0.06681506103038876, -0.32787529956584005, -0.5646185270621825, -0.7594865813642139, -0.8980269903463822, -0.9699648456546798, -0.9699648456546798, -0.8980269903463826, -0.759486581364214, -0.5646185270621829, -0.3278752995658403, -0.0668150610303892, 0.1992005449231202, 0.45044235774153796, 0.6682769215229372, 0.8365484431984722, 0.9427769937964571, 0.9790840876823228, 0.9976687691905392, 0.9606725049005717, 0.8524275557064086, 0.6809619543020885, 0.4589925199408375, 0.2029817101266356, -0.06808332454812321, -0.33409893050163286, -0.575335947180743, -0.7739029286442829, -0.9150730702605976, -0.988376428436431, -0.988376428436431, -0.9150730702605979, -0.773902928644283, -0.5753359471807433, -0.3340989305016331, -0.06808332454812367, 0.2029817101266349, 0.45899251994083695, 0.6809619543020878, 0.8524275557064086, 0.9606725049005715, 0.9976687691905392, 0.9976687691905392, 0.9606725049005717, 0.8524275557064086, 0.6809619543020885, 0.4589925199408375, 0.2029817101266356, -0.06808332454812321, -0.33409893050163286, -0.575335947180743, -0.7739029286442829, -0.9150730702605976, -0.988376428436431, -0.988376428436431, -0.9150730702605979, -0.773902928644283, -0.5753359471807433, -0.3340989305016331, -0.06808332454812367, 0.2029817101266349, 0.45899251994083695, 0.6809619543020878, 0.8524275557064086, 0.9606725049005715, 0.9976687691905392, 0.9790840876823229, 0.9427769937964573, 0.8365484431984723, 0.6682769215229378, 0.45044235774153857, 0.19920054492312092, -0.06681506103038876, -0.3278752995658401, -0.5646185270621826, -0.7594865813642139, -0.8980269903463823, -0.9699648456546799, -0.9699648456546799, -0.8980269903463827, -0.759486581364214, -0.564618527062183, -0.32787529956584033, -0.06681506103038921, 0.19920054492312023, 0.450442357741538, 0.6682769215229372, 0.8365484431984723, 0.9427769937964572, 0.9790840876823229, 0.9422609221188205, 0.9073193311004907, 0.8050860160041878, 0.6431431541243084, 0.4335013066871854, 0.19170865046959368, -0.06430215934460852, -0.31554397216302643, -0.543383332083733, -0.7309224360771269, -0.8642523667343315, -0.9334846530423491, -0.9334846530423491, -0.8642523667343318, -0.730922436077127, -0.5433833320837334, -0.3155439721630266, -0.06430215934460895, 0.191708650469593, 0.43350130668718484, 0.6431431541243078, 0.8050860160041878, 0.9073193311004906, 0.9422609221188205, 0.8878852184023752, 0.8549600259802236, 0.7586263596129864, 0.6060288466379224, 0.40848494650522105, 0.1806455865845144, -0.060591430094595986, -0.29733465759093874, -0.5120259337493107, -0.6887425887642821, -0.8143783567582958, -0.8796154075646312, -0.8796154075646312, -0.8143783567582961, -0.6887425887642822, -0.512025933749311, -0.29733465759093897, -0.060591430094596395, 0.1806455865845138, 0.40848494650522055, 0.6060288466379218, 0.7586263596129864, 0.8549600259802235, 0.8878852184023752, 0.8169698930104421, 0.7866744332224368, 0.6980349295183904, 0.5576253683892848, 0.3758592846530644, 0.16621743721594148, -0.05575199714530954, -0.2735865609267089, -0.47113046105941014, -0.6337327701737817, -0.7493340188588782, -0.8093605913402497, -0.8093605913402497, -0.7493340188588784, -0.6337327701737818, -0.4711304610594104, -0.2735865609267091, -0.055751997145309914, 0.16621743721594093, 0.3758592846530639, 0.5576253683892842, 0.6980349295183904, 0.7866744332224367, 0.8169698930104421, 0.7308359642781244, 0.7037345842189047, 0.6244404294196738, 0.4988343845952698, 0.33623207548089823, 0.1486929714875044, -0.04987400997603561, -0.244742064278067, -0.4214587192930382, -0.566917709143393, -0.670331005982531, -0.7240289186682477, -0.7240289186682477, -0.6703310059825314, -0.5669177091433931, -0.4214587192930384, -0.24474206427806713, -0.04987400997603595, 0.1486929714875039, 0.33623207548089784, 0.4988343845952693, 0.6244404294196738, 0.7037345842189047, 0.7308359642781244, 0.631087944326053, 0.6076854914283419, 0.5392137856075337, 0.4307510600471465, 0.2903414989180408, 0.12839863703816137, -0.043066964366158915, -0.21133848604169353, -0.36393599901675744, -0.4895420438411615, -0.5788409947796997, -0.6252099571567791, -0.6252099571567791, -0.5788409947797, -0.48954204384116157, -0.36393599901675766, -0.21133848604169367, -0.043066964366159206, 0.12839863703816093, 0.29034149891804045, 0.43075106004714603, 0.5392137856075337, 0.6076854914283418, 0.631087944326053, 0.5195839500354338, 0.5003163677175744, 0.4439426092011878, 0.3546436582626495, 0.2390424095775529, 0.10571247892034834, -0.03545766269596658, -0.1739980716781351, -0.2996338396721489, -0.40304713651128704, -0.47656827105334437, -0.5147445170861473, -0.5147445170861473, -0.47656827105334454, -0.4030471365112871, -0.29963383967214907, -0.17399807167813525, -0.03545766269596682, 0.10571247892034798, 0.23904240957755263, 0.3546436582626491, 0.4439426092011878, 0.5003163677175744, 0.5195839500354338, 0.3984010898462418, 0.38362729671115003, 0.340401621957098, 0.27192991613628975, 0.18329041243224337, 0.08105709733594056, -0.02718785185822262, -0.13341640245620767, -0.22975006882344476, -0.3090442236226757, -0.3654179821390623, -0.39469036059622925, -0.39469036059622925, -0.3654179821390624, -0.30904422362267575, -0.2297500688234449, -0.13341640245620776, -0.0271878518582228, 0.0810570973359403, 0.18329041243224314, 0.2719299161362895, 0.340401621957098, 0.38362729671115, 0.3984010898462418, 0.2697967711570243, 0.2597919750177168, 0.23051959656054993, 0.18415063418347083, 0.1241240617020994, 0.05489177539408203, -0.018411582781751167, -0.0903494380900486, -0.1555864888963838, -0.20928440158210024, -0.24746064761490305, -0.26728386947124405, -0.26728386947124405, -0.24746064761490313, -0.20928440158210027, -0.1555864888963839, -0.09034943809004865, -0.01841158278175129, 0.05489177539408185, 0.12412406170209925, 0.18415063418347066, 0.23051959656054993, 0.2597919750177168, 0.2697967711570243, 0.13616664909624665, 0.1311172203749975, 0.11634342723990572, 0.09294097434219466, 0.06264551455418926, 0.02770392353585939, -0.009292340754108154, -0.04559943463997384, -0.07852462706212558, -0.10562600712134529, -0.12489358943920469, -0.1348983855785122, -0.1348983855785122, -0.12489358943920473, -0.1056260071213453, -0.07852462706212562, -0.045599434639973874, -0.009292340754108216, 0.027703923535859293, 0.0626455145541892, 0.09294097434219457, 0.11634342723990572, 0.13111722037499748, 0.13616664909624665, 1.2246467991473532e-16, 1.1792335737941345e-16, 1.0463619889072447e-16, 8.358865220906898e-17, 5.634171758570618e-17, 2.491617551521903e-17, -8.357285309313477e-18, -4.101092451449052e-17, -7.062297106092365e-17, -9.499723492236296e-17, -1.1232598845304307e-16, -1.21324037277366e-16, -1.21324037277366e-16, -1.1232598845304312e-16, -9.499723492236297e-17, -7.062297106092368e-17, -4.101092451449055e-17, -8.357285309313532e-18, 2.4916175515218947e-17, 5.634171758570611e-17, 8.358865220906889e-17, 1.0463619889072447e-16, 1.1792335737941345e-16, 1.2246467991473532e-16];
	sphereB = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.03673732226543887, 0.07075000540051661, 0.09951548429477633, 0.1209003549719405, 0.13331859940315757, 0.13584921320865237, 0.12830451233925919, 0.11124405274375099, 0.08593313066391726, 0.05424894140065542, 0.01854135632610036, -0.01854135632610033, -0.05424894140065534, -0.08593313066391725, -0.11124405274375096, -0.12830451233925916, -0.13584921320865237, -0.1333185994031576, -0.12090035497194054, -0.0995154842947764, -0.07075000540051661, -0.03673732226543888, -3.3351210193267846e-17, 0.0, 0.07279029772675573, 0.14018207206457262, 0.19717718340766818, 0.23954856508301015, 0.26415372554791156, 0.26916781261180994, 0.25421895437509806, 0.22041583926671685, 0.17026548969529298, 0.10748732766595556, 0.03673732226543888, -0.036737322265438827, -0.1074873276659554, -0.17026548969529295, -0.2204158392667168, -0.25421895437509806, -0.26916781261180994, -0.2641537255479116, -0.23954856508301023, -0.19717718340766835, -0.14018207206457262, -0.07279029772675576, -6.608115044354815e-17, 0.0, 0.10748732766595546, 0.2070028119607318, 0.2911658446672334, 0.3537344386698744, 0.3900681675837504, 0.3974723249510691, 0.37539777829166254, 0.3254816957469274, 0.25142612480832366, 0.15872342839067308, 0.05424894140065539, -0.0542489414006553, -0.15872342839067285, -0.2514261248083236, -0.3254816957469273, -0.3753977782916625, -0.3974723249510691, -0.3900681675837505, -0.35373443866987453, -0.2911658446672336, -0.2070028119607318, -0.10748732766595552, -9.758012389140333e-17, 0.0, 0.14018207206457262, 0.2699674811344239, 0.3797306371475827, 0.46133090895557977, 0.50871637769482, 0.5183726799230096, 0.4895836518785268, 0.42448444407039104, 0.3279031669326724, 0.20700281196073197, 0.07075000540051664, -0.07075000540051651, -0.20700281196073164, -0.32790316693267235, -0.42448444407039093, -0.48958365187852676, -0.5183726799230096, -0.5087163776948201, -0.46133090895557993, -0.379730637147583, -0.2699674811344239, -0.14018207206457267, -1.272613642598464e-16, 0.0, 0.17026548969529293, 0.3279031669326723, 0.46122176633582984, 0.5603336572790434, 0.6178881642177859, 0.6296167326667605, 0.5946495083587373, 0.5155798503562351, 0.3982719934736832, 0.25142612480832377, 0.08593313066391726, -0.08593313066391713, -0.2514261248083234, -0.39827199347368314, -0.515579850356235, -0.5946495083587373, -0.6296167326667605, -0.617888164217786, -0.5603336572790436, -0.4612217663358302, -0.3279031669326723, -0.170265489695293, -1.5457196619987672e-16, 0.0, 0.19717718340766818, 0.3797306371475827, 0.5341212066823354, 0.6488984497593926, 0.7155498633306777, 0.7291322169615368, 0.6886381696183025, 0.5970709795444823, 0.46122176633582995, 0.29116584466723366, 0.09951548429477637, -0.0995154842947762, -0.2911658446672332, -0.4612217663358299, -0.5970709795444821, -0.6886381696183025, -0.7291322169615368, -0.7155498633306779, -0.6488984497593929, -0.5341212066823358, -0.3797306371475827, -0.19717718340766827, -1.7900318487099478e-16, 0.0, 0.22041583926671682, 0.424484444070391, 0.5970709795444822, 0.7253754918837414, 0.7998822223620534, 0.8150653476254541, 0.7697988047313332, 0.6674398060854931, 0.5155798503562352, 0.32548169574692765, 0.11124405274375103, -0.11124405274375083, -0.32548169574692715, -0.5155798503562352, -0.6674398060854929, -0.7697988047313331, -0.8150653476254541, -0.7998822223620536, -0.7253754918837416, -0.5970709795444826, -0.424484444070391, -0.2204158392667169, -2.0009991289499868e-16, 0.0, 0.23954856508301015, 0.46133090895557977, 0.6488984497593926, 0.7883401610574335, 0.8693142890261095, 0.8858153530259707, 0.8366195446274924, 0.7253754918837415, 0.5603336572790436, 0.3537344386698747, 0.12090035497194054, -0.12090035497194035, -0.35373443866987414, -0.5603336572790435, -0.7253754918837413, -0.8366195446274923, -0.8858153530259707, -0.8693142890261096, -0.7883401610574339, -0.6488984497593931, -0.46133090895557977, -0.23954856508301026, -2.1746915814534348e-16, 0.0, 0.25421895437509806, 0.4895836518785268, 0.6886381696183025, 0.8366195446274924, 0.9225526752914096, 0.9400642944266261, 0.88785564535221, 0.7697988047313333, 0.5946495083587375, 0.3753977782916628, 0.1283045123392592, -0.12830451233925902, -0.37539777829166227, -0.5946495083587374, -0.7697988047313331, -0.8878556453522098, -0.9400642944266261, -0.9225526752914098, -0.8366195446274928, -0.688638169618303, -0.4895836518785268, -0.25421895437509817, -2.307873644468894e-16, 0.0, 0.26415372554791156, 0.50871637769482, 0.7155498633306777, 0.8693142890261095, 0.9586056507527264, 0.9768016166920649, 0.9225526752914096, 0.7998822223620535, 0.6178881642177861, 0.39006816758375074, 0.13331859940315763, -0.1333185994031574, -0.3900681675837502, -0.617888164217786, -0.7998822223620533, -0.9225526752914095, -0.9768016166920649, -0.9586056507527266, -0.8693142890261097, -0.7155498633306783, -0.50871637769482, -0.26415372554791167, -2.3980643881525265e-16, 0.0, 0.26916781261180994, 0.5183726799230096, 0.7291322169615368, 0.8858153530259707, 0.9768016166920649, 0.9953429730181653, 0.9400642944266261, 0.8150653476254542, 0.6296167326667608, 0.39747232495106943, 0.13584921320865243, -0.1358492132086522, -0.3974723249510688, -0.6296167326667607, -0.815065347625454, -0.940064294426626, -0.9953429730181653, -0.9768016166920651, -0.885815353025971, -0.7291322169615374, -0.5183726799230096, -0.26916781261181005, -2.443583729596947e-16, 0.0, 0.26916781261180994, 0.5183726799230096, 0.7291322169615368, 0.8858153530259707, 0.9768016166920649, 0.9953429730181653, 0.9400642944266261, 0.8150653476254542, 0.6296167326667608, 0.39747232495106943, 0.13584921320865243, -0.1358492132086522, -0.3974723249510688, -0.6296167326667607, -0.815065347625454, -0.940064294426626, -0.9953429730181653, -0.9768016166920651, -0.885815353025971, -0.7291322169615374, -0.5183726799230096, -0.26916781261181005, -2.443583729596947e-16, 0.0, 0.26415372554791156, 0.5087163776948201, 0.7155498633306778, 0.8693142890261095, 0.9586056507527265, 0.976801616692065, 0.9225526752914097, 0.7998822223620536, 0.6178881642177861, 0.3900681675837508, 0.13331859940315766, -0.13331859940315743, -0.3900681675837502, -0.617888164217786, -0.7998822223620534, -0.9225526752914096, -0.976801616692065, -0.9586056507527266, -0.8693142890261099, -0.7155498633306784, -0.5087163776948201, -0.26415372554791167, -2.3980643881525265e-16, 0.0, 0.25421895437509806, 0.4895836518785268, 0.6886381696183025, 0.8366195446274924, 0.9225526752914096, 0.9400642944266261, 0.88785564535221, 0.7697988047313333, 0.5946495083587375, 0.3753977782916628, 0.1283045123392592, -0.12830451233925902, -0.37539777829166227, -0.5946495083587374, -0.7697988047313331, -0.8878556453522098, -0.9400642944266261, -0.9225526752914098, -0.8366195446274928, -0.688638169618303, -0.4895836518785268, -0.25421895437509817, -2.307873644468894e-16, 0.0, 0.23954856508301015, 0.46133090895557977, 0.6488984497593926, 0.7883401610574335, 0.8693142890261095, 0.8858153530259707, 0.8366195446274924, 0.7253754918837415, 0.5603336572790436, 0.3537344386698747, 0.12090035497194054, -0.12090035497194035, -0.35373443866987414, -0.5603336572790435, -0.7253754918837413, -0.8366195446274923, -0.8858153530259707, -0.8693142890261096, -0.7883401610574339, -0.6488984497593931, -0.46133090895557977, -0.23954856508301026, -2.1746915814534348e-16, 0.0, 0.22041583926671685, 0.42448444407039104, 0.5970709795444823, 0.7253754918837415, 0.7998822223620535, 0.8150653476254542, 0.7697988047313333, 0.6674398060854932, 0.5155798503562353, 0.3254816957469277, 0.11124405274375104, -0.11124405274375086, -0.3254816957469272, -0.5155798503562352, -0.667439806085493, -0.7697988047313332, -0.8150653476254542, -0.7998822223620538, -0.7253754918837417, -0.5970709795444827, -0.42448444407039104, -0.22041583926671693, -2.000999128949987e-16, 0.0, 0.1971771834076683, 0.3797306371475829, 0.5341212066823356, 0.6488984497593929, 0.715549863330678, 0.7291322169615372, 0.6886381696183028, 0.5970709795444825, 0.4612217663358302, 0.2911658446672338, 0.09951548429477641, -0.09951548429477625, -0.29116584466723333, -0.4612217663358301, -0.5970709795444824, -0.6886381696183027, -0.7291322169615372, -0.7155498633306782, -0.6488984497593931, -0.534121206682336, -0.3797306371475829, -0.19717718340766838, -1.7900318487099488e-16, 0.0, 0.17026548969529298, 0.3279031669326724, 0.46122176633582995, 0.5603336572790436, 0.6178881642177861, 0.6296167326667608, 0.5946495083587375, 0.5155798503562353, 0.39827199347368336, 0.2514261248083239, 0.08593313066391729, -0.08593313066391715, -0.2514261248083235, -0.39827199347368325, -0.5155798503562352, -0.5946495083587374, -0.6296167326667608, -0.6178881642177863, -0.5603336572790437, -0.46122176633583034, -0.3279031669326724, -0.17026548969529307, -1.5457196619987677e-16, 0.0, 0.14018207206457267, 0.26996748113442404, 0.3797306371475829, 0.46133090895557993, 0.5087163776948203, 0.5183726799230098, 0.489583651878527, 0.4244844440703912, 0.3279031669326725, 0.20700281196073206, 0.07075000540051667, -0.07075000540051656, -0.20700281196073175, -0.32790316693267246, -0.4244844440703911, -0.4895836518785269, -0.5183726799230098, -0.5087163776948204, -0.4613309089555801, -0.37973063714758315, -0.26996748113442404, -0.14018207206457273, -1.2726136425984645e-16, 0.0, 0.10748732766595556, 0.20700281196073197, 0.29116584466723366, 0.3537344386698747, 0.39006816758375074, 0.39747232495106943, 0.3753977782916628, 0.3254816957469277, 0.2514261248083239, 0.15872342839067322, 0.05424894140065544, -0.05424894140065535, -0.15872342839067297, -0.2514261248083238, -0.3254816957469276, -0.3753977782916628, -0.39747232495106943, -0.39006816758375085, -0.3537344386698748, -0.2911658446672339, -0.20700281196073197, -0.1074873276659556, -9.758012389140342e-17, 0.0, 0.07279029772675573, 0.14018207206457262, 0.19717718340766818, 0.23954856508301015, 0.26415372554791156, 0.26916781261180994, 0.25421895437509806, 0.22041583926671685, 0.17026548969529298, 0.10748732766595556, 0.03673732226543888, -0.036737322265438827, -0.1074873276659554, -0.17026548969529295, -0.2204158392667168, -0.25421895437509806, -0.26916781261180994, -0.2641537255479116, -0.23954856508301023, -0.19717718340766835, -0.14018207206457262, -0.07279029772675576, -6.608115044354815e-17, 0.0, 0.03673732226543888, 0.07075000540051664, 0.09951548429477637, 0.12090035497194054, 0.13331859940315763, 0.13584921320865243, 0.1283045123392592, 0.11124405274375104, 0.08593313066391729, 0.05424894140065544, 0.018541356326100367, -0.01854135632610034, -0.05424894140065536, -0.08593313066391728, -0.111244052743751, -0.1283045123392592, -0.13584921320865243, -0.13331859940315766, -0.12090035497194059, -0.09951548429477644, -0.07075000540051664, -0.036737322265438896, -3.335121019326786e-17, 0.0, 3.304057522177407e-17, 6.36306821299232e-17, 8.950159243549739e-17, 1.0873457907267174e-16, 1.1990321940762632e-16, 1.2217918647984734e-16, 1.153936822234447e-16, 1.0004995644749935e-16, 7.728598309993839e-17, 4.879006194570171e-17, 1.667560509663393e-17, -1.6675605096633902e-17, -4.8790061945701635e-17, -7.728598309993837e-17, -1.0004995644749933e-16, -1.1539368222344468e-16, -1.2217918647984734e-16, -1.1990321940762635e-16, -1.0873457907267179e-16, -8.950159243549747e-17, -6.36306821299232e-17, -3.3040575221774085e-17, -2.999519565323715e-32];
	sphereC = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9906859460363308, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.9629172873477994, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.917211301505453, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.8544194045464886, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.7757112907044199, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.6825531432186541, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.5766803221148672, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.46006503773115215, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.3348796121709863, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.20345601305263397, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, 0.068242413364671, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.06824241336467089, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.20345601305263364, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.33487961217098616, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.4600650377311521, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.576680322114867, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.6825531432186539, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.7757112907044197, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.8544194045464883, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9172113015054528, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9629172873477994, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -0.9906859460363308, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0];

	sphereMeshData =  {
		"i": [2, 3, 471, 496, 291, 266, 289, 266, 528, 553, 554, 554, 289, 314, 314, 337, 146, 121, 567, 568, 542, 567, 542, 519, 289, 265, 556, 557, 384, 409, 436, 436, 434, 457, 409, 434, 435, 434, 217, 192, 169, 192, 169, 145, 27, 51, 1, 25, 25, 25, 120, 120, 174, 151, 176, 151, 29, 29, 10, 33, 176, 200, 177, 153, 213, 189, 333, 333, 333, 332, 286, 263, 239, 215, 263, 238, 71, 46, 46, 47, 573, 549, 455, 430, 561, 538, 491, 468, 543, 519, 496, 520, 570, 547, 571, 572, 351, 376, 376, 353, 328, 353, 351, 328, 329, 330, 328, 305, 545, 570, 568, 545, 426, 449, 443, 468, 444, 443, 418, 395, 443, 418, 494, 519, 494, 494, 447, 423, 470, 446, 516, 491, 468, 492, 469, 445, 494, 469, 469, 446, 337, 312, 312, 312, 240, 241, 241, 217, 337, 361, 360, 384, 362, 362, 362, 339, 409, 432, 457, 432, 481, 482, 456, 457, 559, 536, 536, 561, 536, 513, 441, 418, 557, 534, 534, 559, 460, 485, 291, 315, 314, 315, 411, 387, 364, 388, 413, 388, 388, 365, 243, 267, 554, 531, 506, 507, 531, 531, 531, 508, 98, 74, 121, 97, 75, 98, 51, 50, 52, 75, 49, 49, 50, 49, 128, 153, 151, 128, 81, 80, 7, 6, 199, 199, 224, 199, 176, 199, 244, 245, 75, 100, 195, 172, 172, 147, 41, 16, 18, 42, 65, 41, 41, 64, 137, 160, 42, 43, 19, 43, 106, 105, 128, 105, 80, 105, 131, 130, 130, 153, 130, 105, 12, 35, 35, 60, 35, 10, 58, 35, 58, 81, 58, 33, 190, 213, 190, 190, 190, 167, 165, 190, 165, 141, 165, 164, 163, 163, 164, 163, 212, 188, 235, 211, 211, 211, 259, 260, 259, 283, 307, 330, 282, 283, 332, 307, 307, 308, 303, 328, 303, 280, 357, 381, 311, 286, 334, 334, 334, 311, 333, 357, 334, 310, 165, 142, 167, 142, 94, 71, 142, 119, 94, 119, 45, 69, 45, 46, 574, 550, 573, 550, 430, 407, 383, 359, 407, 382, 382, 382, 382, 381, 562, 538, 539, 564, 516, 539, 275, 276, 276, 252, 230, 207, 355, 332, 380, 355, 478, 478, 455, 479, 478, 453, 449, 425, 471, 447, 448, 448, 246, 246, 245, 269, 370, 395, 225, 225, 225, 249, 321, 298, 323, 298, 276, 301, 421, 421, 446, 421, 423, 399, 376, 400, 400, 400, 400, 401, 564, 541, 565, 541, 410, 386, 386, 387, 409, 386, 361, 362, 529, 505, 505, 506, 528, 504, 505, 481, 511, 536, 534, 511, 511, 488, 488, 513, 439, 462, 483, 508, 483, 483, 509, 534, 532, 508, 485, 509, 462, 437, 460, 437, 437, 413, 97, 96, 120, 96, 28, 3, 28, 28, 5, 29, 28, 52, 48, 72, 25, 49, 149, 126, 151, 126, 32, 32, 55, 31, 9, 33, 56, 32, 149, 148, 266, 242, 243, 242, 242, 241, 242, 218, 194, 194, 218, 194, 15, 39, 16, 39, 64, 39, 39, 62, 62, 37, 37, 38, 37, 60, 13, 12, 160, 184, 89, 64, 89, 90, 253, 276, 44, 44, 21, 45, 180, 156, 67, 91, 139, 115, 116, 91, 163, 139, 162, 186, 137, 162, 258, 258, 285, 285, 286, 285, 308, 285, 260, 261, 238, 237, 237, 261, 213, 212, 237, 237, 404, 404, 117, 142, 117, 116, 527, 503, 526, 550, 526, 525, 466, 441, 465, 466, 466, 443, 491, 490, 514, 513, 514, 490, 514, 539, 514, 514, 160, 135, 135, 158, 111, 110, 158, 133, 133, 133, 426, 427, 522, 547, 522, 522, 473, 473, 473, 448, 182, 207, 183, 182, 157, 158, 501, 478, 526, 501, 406, 430, 429, 453, 429, 404, 427, 452, 452, 475, 452, 429, 452, 476, 547, 524, 524, 524, 354, 355, 354, 378, 354, 354, 353, 354, 222, 199, 246, 247, 222, 221, 365, 342, 317, 318, 294, 269, 294, 294, 271, 295, 294, 318, 390, 365, 418, 393, 393, 370, 393, 368, 441, 416, 416, 393, 224, 248, 247, 248, 248, 225, 295, 319, 296, 272, 321, 296, 248, 273, 273, 296, 323, 346, 370, 346, 275, 251, 274, 298, 274, 274, 274, 273, 374, 350, 374, 374, 351, 350, 326, 325, 419, 395, 396, 372, 300, 324, 301, 324, 494, 517, 542, 541, 517, 517, 516, 517, 439, 464, 464, 464, 464, 441, 488, 464, 509, 486, 486, 462, 511, 486, 486, 487, 436, 460, 459, 483, 459, 434, 459, 459, 339, 340, 315, 316, 340, 365, 340, 340, 269, 292, 317, 316, 292, 292, 292, 292, 54, 29, 31, 54, 101, 126, 124, 101, 79, 54, 80, 79, 220, 220, 220, 195, 220, 220, 173, 173, 174, 173, 100, 124, 147, 123, 123, 98, 123, 123, 146, 170, 169, 170, 170, 147, 195, 194, 64, 87, 86, 86, 86, 87, 112, 87, 135, 112, 114, 114, 91, 114, 253, 254, 254, 254, 254, 255, 254, 229, 229, 228, 256, 232, 256, 255, 68, 91, 43, 44, 68, 68, 132, 132, 133, 109, 156, 132, 130, 155, 132, 155, 155, 179, 225, 202, 107, 83, 60, 84, 83, 106, 83, 58, 207, 208, 184, 208, 208, 209, 209, 234, 234, 211, 259, 258, 305, 281, 281, 280, 68, 93, 93, 93, 93, 94, 93, 117, 380, 404, 403, 427, 522, 498, 545, 521, 521, 497, 520, 521, 451, 475, 498, 474, 474, 474, 473, 474, 501, 500, 500, 524, 500, 475, 499, 500, 343, 343, 414, 437, 414, 390, 344, 344, 345, 345, 345, 346, 368, 344, 321, 345, 398, 398, 399, 398, 303, 279, 302, 326, 302, 278, 302, 301, 397, 397, 397, 396, 374, 398, 421, 397, 348, 347, 323, 324, 373, 372, 348, 348, 52, 77, 77, 77, 54, 77, 101, 77, 103, 126, 79, 78, 103, 128, 103, 103, 197, 220, 172, 173, 197, 222, 198, 197, 62, 86, 109, 85, 85, 85, 85, 84, 137, 113, 113, 114, 113, 112, 89, 113, 155, 178, 178, 178, 177, 178, 226, 227, 227, 227, 205, 205, 205, 204, 182, 205, 230, 229, 185, 185, 185, 185, 162, 185, 210, 209, 257, 234, 257, 281, 257, 233, 256, 257, 402, 402, 402, 403, 402, 401, 402, 378, 367, 390, 342, 343, 367, 367, 344, 367, 415, 414, 415, 415, 415, 439, 416, 392, 178, 203, 202, 203, 203, 204, 227, 203],
		"j": [3, 27, 496, 471, 266, 291, 266, 289, 553, 528, 553, 529, 314, 289, 337, 314, 121, 146, 543, 567, 567, 542, 519, 542, 288, 288, 532, 532, 409, 384, 411, 435, 457, 434, 434, 409, 434, 410, 192, 217, 192, 169, 168, 169, 51, 50, 25, 24, 1, 2, 121, 145, 151, 174, 151, 176, 5, 6, 33, 10, 177, 177, 176, 177, 212, 213, 332, 308, 357, 333, 263, 286, 238, 238, 238, 263, 46, 71, 22, 46, 572, 573, 430, 455, 538, 561, 468, 491, 520, 520, 520, 519, 547, 570, 547, 547, 376, 351, 353, 376, 353, 328, 328, 351, 305, 305, 305, 328, 570, 545, 545, 568, 449, 426, 468, 443, 443, 419, 395, 418, 418, 443, 519, 494, 471, 470, 446, 446, 446, 447, 491, 516, 469, 469, 468, 469, 469, 494, 446, 469, 312, 337, 289, 288, 241, 265, 240, 241, 360, 360, 361, 360, 337, 361, 339, 362, 432, 409, 432, 457, 457, 481, 481, 481, 536, 559, 561, 536, 513, 536, 418, 441, 534, 557, 559, 534, 485, 460, 315, 314, 315, 339, 388, 388, 388, 387, 388, 413, 365, 388, 244, 244, 531, 554, 531, 531, 556, 532, 508, 531, 97, 97, 97, 98, 98, 75, 75, 75, 75, 52, 74, 50, 49, 25, 153, 128, 128, 151, 80, 56, 31, 31, 174, 198, 199, 224, 199, 176, 245, 269, 100, 75, 172, 195, 147, 172, 16, 41, 41, 41, 41, 42, 64, 41, 160, 137, 43, 67, 43, 42, 105, 81, 105, 128, 105, 80, 130, 106, 153, 130, 105, 130, 35, 12, 60, 35, 10, 35, 35, 58, 81, 58, 33, 58, 213, 190, 191, 215, 167, 190, 190, 165, 164, 165, 189, 165, 164, 188, 163, 139, 211, 211, 211, 212, 186, 210, 235, 259, 260, 259, 330, 307, 307, 307, 307, 332, 283, 307, 328, 303, 280, 303, 380, 380, 286, 311, 335, 359, 311, 334, 334, 334, 333, 334, 142, 165, 142, 167, 71, 94, 119, 142, 119, 94, 46, 45, 21, 45, 550, 551, 550, 573, 407, 430, 382, 382, 382, 407, 381, 357, 406, 382, 539, 539, 564, 539, 539, 516, 276, 300, 275, 276, 207, 230, 332, 355, 355, 380, 479, 503, 478, 478, 453, 478, 448, 448, 448, 448, 447, 423, 247, 271, 246, 246, 395, 370, 200, 224, 226, 225, 298, 321, 298, 323, 301, 276, 444, 445, 421, 446, 400, 400, 400, 399, 425, 401, 376, 400, 541, 564, 541, 542, 386, 387, 362, 386, 386, 409, 386, 386, 505, 506, 481, 505, 505, 505, 504, 505, 536, 511, 511, 534, 488, 511, 513, 488, 462, 439, 508, 483, 506, 507, 534, 509, 509, 509, 509, 508, 437, 462, 437, 460, 436, 437, 96, 72, 96, 97, 3, 28, 51, 52, 28, 28, 29, 28, 49, 48, 48, 48, 126, 149, 126, 151, 7, 31, 32, 32, 32, 32, 32, 33, 124, 124, 242, 243, 242, 218, 266, 242, 241, 242, 217, 218, 194, 195, 39, 38, 39, 16, 39, 64, 62, 39, 37, 62, 13, 37, 60, 37, 37, 37, 184, 183, 64, 89, 65, 89, 276, 253, 19, 43, 44, 44, 156, 157, 91, 90, 116, 116, 91, 116, 162, 162, 163, 162, 162, 137, 283, 259, 286, 310, 285, 261, 285, 308, 285, 285, 237, 213, 238, 237, 237, 237, 260, 261, 380, 381, 142, 117, 141, 117, 526, 526, 527, 526, 550, 526, 441, 466, 466, 490, 443, 466, 466, 466, 538, 514, 513, 514, 539, 514, 491, 490, 135, 160, 158, 135, 135, 135, 133, 158, 109, 110, 427, 451, 547, 522, 498, 499, 496, 497, 448, 473, 207, 182, 182, 158, 182, 182, 478, 501, 501, 526, 429, 429, 430, 429, 404, 429, 452, 427, 475, 452, 429, 452, 453, 452, 524, 547, 549, 525, 330, 354, 355, 354, 353, 329, 354, 378, 199, 222, 222, 222, 246, 222, 342, 365, 342, 342, 269, 294, 318, 317, 294, 294, 295, 294, 365, 390, 393, 418, 370, 393, 368, 393, 416, 441, 393, 416, 248, 247, 248, 272, 225, 248, 296, 296, 295, 296, 296, 321, 273, 248, 296, 273, 346, 323, 346, 347, 274, 274, 275, 274, 249, 273, 298, 274, 373, 374, 351, 350, 326, 326, 350, 326, 396, 396, 395, 396, 324, 323, 324, 301, 517, 494, 517, 517, 516, 492, 517, 541, 464, 439, 488, 487, 441, 464, 464, 465, 486, 509, 485, 486, 486, 511, 462, 486, 459, 459, 460, 459, 434, 459, 482, 483, 340, 364, 340, 340, 365, 340, 317, 316, 292, 269, 292, 292, 291, 267, 315, 316, 29, 54, 54, 31, 126, 101, 101, 124, 54, 79, 79, 55, 245, 221, 195, 220, 244, 243, 172, 148, 173, 149, 123, 123, 123, 124, 98, 123, 146, 147, 170, 169, 170, 194, 147, 170, 170, 170, 87, 64, 111, 87, 62, 86, 87, 112, 112, 135, 115, 139, 114, 91, 254, 278, 279, 255, 230, 254, 229, 254, 253, 229, 255, 256, 280, 256, 91, 68, 68, 68, 45, 44, 131, 107, 132, 132, 132, 133, 155, 130, 155, 132, 156, 155, 202, 225, 83, 84, 83, 83, 106, 83, 58, 83, 208, 232, 208, 207, 209, 233, 234, 209, 211, 234, 234, 234, 281, 282, 305, 281, 93, 68, 116, 117, 69, 93, 94, 93, 403, 403, 404, 403, 521, 521, 521, 522, 520, 521, 521, 545, 474, 474, 474, 475, 449, 473, 474, 498, 500, 476, 501, 500, 475, 500, 500, 524, 318, 342, 437, 414, 413, 414, 319, 343, 370, 346, 321, 345, 345, 345, 345, 344, 423, 399, 398, 374, 302, 302, 303, 302, 301, 302, 326, 302, 396, 372, 421, 397, 397, 397, 397, 398, 372, 348, 348, 348, 348, 348, 325, 324, 77, 52, 100, 101, 77, 54, 77, 78, 126, 103, 103, 103, 128, 103, 80, 79, 220, 197, 197, 197, 222, 197, 197, 173, 85, 85, 85, 86, 60, 84, 109, 85, 113, 114, 89, 113, 137, 113, 113, 112, 178, 155, 177, 153, 178, 202, 227, 251, 252, 228, 180, 204, 229, 205, 205, 182, 205, 205, 160, 184, 208, 209, 185, 162, 185, 185, 234, 257, 258, 257, 256, 257, 257, 281, 427, 403, 378, 402, 426, 402, 401, 402, 390, 367, 367, 367, 368, 392, 367, 344, 439, 415, 414, 390, 416, 415, 415, 415, 203, 178, 203, 227, 179, 203, 203, 204],
		"k": [26, 26, 495, 472, 267, 290, 290, 265, 552, 529, 529, 530, 313, 290, 313, 338, 122, 145, 544, 544, 566, 543, 543, 518, 265, 264, 557, 533, 408, 385, 412, 411, 433, 458, 433, 410, 411, 411, 193, 216, 168, 193, 144, 144, 26, 26, 0, 0, 2, 26, 145, 144, 175, 150, 152, 175, 6, 30, 9, 34, 200, 201, 152, 152, 188, 188, 308, 309, 356, 356, 287, 262, 215, 214, 239, 262, 47, 70, 23, 23, 548, 548, 431, 454, 562, 537, 492, 467, 544, 543, 495, 495, 571, 546, 572, 548, 375, 352, 377, 352, 352, 329, 352, 327, 330, 306, 329, 304, 569, 546, 569, 544, 425, 450, 467, 444, 420, 420, 419, 394, 419, 442, 518, 495, 495, 471, 423, 422, 471, 471, 492, 515, 492, 493, 444, 444, 470, 493, 470, 445, 313, 336, 313, 289, 264, 264, 216, 216, 336, 337, 385, 385, 338, 337, 363, 338, 408, 433, 433, 456, 458, 458, 480, 456, 560, 535, 560, 537, 537, 512, 442, 417, 558, 533, 558, 535, 484, 461, 290, 290, 338, 338, 412, 411, 363, 363, 389, 412, 389, 364, 267, 268, 555, 530, 530, 506, 555, 556, 532, 507, 74, 73, 122, 122, 74, 99, 50, 74, 51, 76, 73, 74, 26, 26, 152, 129, 152, 127, 57, 57, 6, 30, 175, 174, 200, 223, 175, 200, 268, 268, 99, 76, 196, 171, 148, 171, 17, 40, 17, 18, 66, 66, 40, 65, 136, 161, 66, 66, 18, 18, 82, 82, 129, 104, 104, 81, 107, 107, 129, 154, 106, 129, 11, 36, 59, 36, 11, 34, 59, 34, 57, 82, 34, 57, 189, 214, 215, 214, 191, 166, 189, 166, 140, 140, 188, 188, 188, 187, 140, 140, 188, 187, 236, 236, 187, 186, 236, 236, 284, 284, 306, 331, 306, 282, 308, 331, 284, 284, 327, 304, 304, 279, 356, 357, 287, 310, 359, 358, 335, 310, 357, 358, 309, 309, 166, 141, 143, 166, 95, 70, 143, 118, 118, 95, 70, 70, 22, 22, 575, 575, 574, 549, 431, 406, 359, 358, 383, 406, 357, 358, 405, 405, 563, 562, 563, 540, 515, 540, 299, 299, 251, 251, 231, 206, 356, 331, 356, 379, 503, 502, 454, 455, 454, 477, 425, 424, 472, 471, 423, 424, 271, 270, 269, 270, 394, 371, 201, 200, 250, 250, 322, 297, 299, 322, 300, 277, 420, 444, 422, 445, 424, 423, 375, 375, 424, 425, 377, 377, 565, 540, 566, 566, 411, 411, 363, 363, 410, 385, 385, 361, 530, 530, 482, 482, 529, 528, 480, 480, 535, 512, 535, 510, 512, 487, 512, 489, 438, 463, 507, 484, 482, 506, 533, 510, 533, 532, 484, 484, 438, 461, 461, 436, 412, 412, 73, 73, 121, 121, 4, 27, 27, 51, 4, 5, 53, 53, 73, 73, 24, 25, 150, 125, 127, 150, 8, 7, 56, 55, 8, 9, 57, 57, 125, 149, 267, 267, 219, 219, 265, 265, 217, 217, 193, 217, 219, 219, 14, 14, 15, 40, 40, 63, 38, 63, 38, 61, 14, 14, 36, 61, 12, 36, 159, 159, 65, 88, 66, 66, 252, 277, 20, 19, 20, 21, 181, 181, 66, 66, 140, 139, 92, 115, 139, 138, 187, 187, 161, 138, 282, 283, 310, 309, 262, 262, 309, 284, 284, 260, 214, 214, 262, 262, 212, 236, 236, 260, 381, 405, 141, 118, 140, 140, 503, 502, 551, 551, 549, 549, 442, 465, 489, 489, 467, 442, 467, 491, 537, 537, 489, 489, 538, 515, 515, 491, 136, 159, 134, 159, 110, 134, 134, 157, 110, 134, 450, 450, 546, 523, 499, 523, 472, 496, 449, 472, 206, 183, 159, 159, 181, 157, 502, 477, 502, 525, 405, 406, 454, 454, 405, 428, 451, 428, 451, 476, 453, 428, 477, 477, 548, 523, 548, 549, 331, 331, 379, 379, 329, 330, 377, 377, 223, 198, 247, 223, 245, 245, 366, 341, 341, 317, 270, 293, 317, 293, 270, 271, 319, 319, 366, 389, 394, 417, 394, 369, 369, 392, 417, 440, 417, 392, 223, 223, 271, 271, 249, 224, 319, 320, 271, 271, 297, 320, 272, 249, 272, 297, 322, 347, 371, 371, 251, 250, 299, 299, 250, 249, 297, 297, 349, 349, 375, 351, 327, 351, 349, 349, 420, 419, 371, 371, 299, 299, 300, 325, 493, 518, 518, 542, 492, 493, 540, 540, 463, 440, 487, 463, 465, 440, 489, 489, 510, 485, 461, 461, 487, 510, 463, 463, 435, 436, 484, 484, 435, 458, 458, 482, 363, 363, 339, 315, 364, 341, 341, 317, 268, 293, 293, 317, 267, 268, 291, 315, 30, 53, 30, 55, 125, 102, 125, 100, 55, 78, 56, 56, 244, 245, 196, 219, 243, 219, 148, 149, 150, 150, 99, 100, 148, 148, 99, 122, 122, 146, 145, 145, 193, 193, 171, 146, 171, 195, 63, 88, 110, 111, 63, 63, 88, 111, 136, 111, 139, 138, 90, 115, 277, 277, 278, 279, 231, 231, 230, 253, 252, 252, 231, 231, 279, 279, 67, 92, 67, 43, 69, 45, 107, 108, 109, 108, 157, 157, 154, 131, 131, 156, 180, 180, 226, 201, 108, 108, 59, 60, 82, 107, 59, 82, 231, 231, 183, 183, 232, 232, 233, 210, 235, 210, 235, 259, 306, 306, 304, 304, 92, 69, 92, 116, 70, 70, 118, 118, 379, 380, 428, 428, 498, 497, 546, 546, 496, 496, 544, 544, 450, 451, 499, 499, 450, 449, 497, 497, 477, 477, 525, 525, 476, 499, 523, 523, 319, 318, 413, 438, 389, 389, 320, 319, 369, 370, 322, 322, 369, 368, 320, 320, 422, 423, 375, 375, 279, 278, 327, 327, 277, 277, 325, 325, 372, 373, 420, 420, 373, 374, 422, 422, 371, 371, 347, 323, 349, 373, 349, 325, 76, 53, 76, 100, 53, 78, 102, 102, 102, 127, 78, 102, 127, 104, 104, 80, 196, 221, 196, 172, 221, 198, 174, 174, 61, 62, 110, 110, 61, 60, 108, 108, 138, 138, 90, 90, 136, 136, 88, 88, 154, 179, 153, 154, 201, 201, 250, 250, 251, 252, 181, 180, 228, 228, 181, 206, 206, 230, 161, 160, 184, 208, 161, 186, 186, 210, 258, 233, 282, 282, 232, 232, 280, 280, 426, 427, 379, 379, 425, 425, 377, 377, 366, 391, 366, 342, 392, 391, 343, 368, 438, 438, 390, 391, 440, 440, 392, 391, 202, 179, 226, 226, 180, 180, 228, 228],
		"name": "",
		"type": "mesh3d",
		x: sphereA.map(x => x * 1),
		y: sphereB.map(x => x * 1),
		z: sphereC.map(x => x * 1),
		"color": "rgb(200,0,0)",
		text: [], // Non mostrare nessun dato aggiuntivo nei tooltip della sfera
        hoverinfo :  "none"
	};

	orbiterName="[noOrbiterName]";
	orbiterID = "[noOrbiterId]";
	orbiterIDs = [
	{id: "-152",   name: "Chandrayaan2"},
	{id: "-64",    name: "OSIRIS-REX"},
	{id: "-37",    name: "Hayabusa 2"},
	{id: "-189",   name: "Insight"},
	{id: "-74",    name: "MRO"},
	{id: "-85",    name: "LRO"},
	{id: "-84",    name: "Phoenix", radius: "3236.7682"},
	{id: "-189",    name: "Insight", radius: "3395.456"},
	{id: "-76",    name: "MSL", radius: "3393.5044"},
	{id: "-253",    name: "Opportunity", radius: "3236.7682"},
	{id: "-254",    name: "Spirit", radius: "3401.1857"},
	{id: "-9901491",    name: "Tianwen-1"},
	{id: "-168",    name: "Mars2020"},
	{id: "-62",    name: "Hope"},
	{id: "-135",    name: "Dart"},
	{id: "162173", name: "Ryugu"},
	{id: "@2101955", name: "Bennu",  radius: "0.262"},
	{id: "@399", name: "Earth", radius: "6300"},
	{id: "@499", name: "Mars", radius: "3389"},
	{id: "@162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "2065803", name: "65803 Didymos (1996 GT)", radius: "0.435"},
	{id: "DES=2065803", name: "65803 Didymos (1996 GT)", radius: "0.435"},
	{id: "@2065803", name: "65803 Didymos (1996 GT)", radius: "1"},
	{id: "@0", name: "Sun", radius: "696340"},
	];
	 /*
	 * -152 	= Chandrayaan2
	 * -64 		= OSIRIS-REX
	 * -37 		= Hayabusa 2
	 * -189  	= Insight
	 * 162173 	= Ryugu
	 * -85 		= LRO
	 * -74 		= MRO
	 */

	bodyID = "[noBodyName]";
	bodyIDs = [{id: "@301", name: "Moon", radius: "1737"},
	{id: "@2101955", name: "Bennu",  radius: "0.262"},
	{id: "@399", name: "Earth", radius: "6300"},
	{id: "@499", name: "Mars", radius: "3389"},
	{id: "@162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "-152",   name: "Chandrayaan2"},
	{id: "-64",    name: "OSIRIS-REX"},
	{id: "-37",    name: "Hayabusa 2"},
	{id: "-189",   name: "Insight"},
	{id: "-74",    name: "MRO"},
	{id: "-85",    name: "LRO"},
	{id: "-84",    name: "Phoenix", radius: "3236.7682"},
	{id: "-9901491",    name: "Tianwen-1"},
	{id: "-168",    name: "Mars2020"},
	{id: "-62",    name: "Hope"},
	{id: "-135",    name: "Dart"},
	{id: "162173", name: "Ryugu"},
	{id: "@2101955", name: "Bennu",  radius: "0.262"},
	{id: "@399", name: "Earth", radius: "6300"},
	{id: "@499", name: "Mars", radius: "3389"},
	{id: "@162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "162173", name: "Ryugu (1999 JU3)", radius: "0.435"},
	{id: "2065803", name: "65803 Didymos (1996 GT)", radius: "0.435"},
	{id: "DES=2065803", name: "65803 Didymos (1996 GT)", radius: "0.435"},
	{id: "@2065803", name: "65803 Didymos (1996 GT)", radius: "1"},
	{id: "@0", name: "Sun", radius: "696340"},
	];
	/*  301 	= Moon
	*	2101955 = Bennu asteroid (OSIRIS-REX)
	*	399 	= Earth
	*	499 	= Mars
	*	162173 	= Ryugu (1999 JU3)  (NOT WORKING)
	*	-37 	= Hayabusa 2
	*/

	bodyRadius = 0; //1737; // Moon = 1737; Bennu = 0.5;
	TIME_STEP= '720m';
	TIME_STEP_min = convertTimestepToMinutes(TIME_STEP, null, null);

	progressStatusIndex = 0;
	progressStatusArray = ["-", "\\", "|", "/", "-", "\\", "|", "/"];
	PROGRESS_SYMBOLS_COUNT = 8;

	START_DATE_data = '2000-00-00 00:00';
	END_DATE_data = '2000-00-00 00:00';
	START_DATE_chart = '2000-00-00 00:00';
	END_DATE_chart = '2000-00-00 00:00';


	ERR_MISSING_PARAM_str= "[missing param in URL]";

	var ephemeris;
	var trace3d;
	//var trace2;
	var trace2d_Before;
	var trace2d_After;
	var temp_Before = {x:[], y:[]};
	var temp_After = {x:[], y:[]};
	var trace2d_edges;
	var trace3d_today;
	var trace2d_today;
	var fullURL;
	var distance1;
	var distance2;
	var today;
	var todayms;
	var coords;
	var dateArray;
	var velArray;
	var fact;
	var chartPoints3d;
	var chartPoints2d;
	var chartPoints2dAfter;
	var layout;
	var layout2d;
	
	traces3d = [];
	traces2d = [];


function getParam(text,defaultVal) {
	regex = "/.*" + text + "=([^&]*).*|(.*)/"
	var url = new URL(document.URL);
	temp =  url.searchParams.get(text);
console.log("Parametro " + text + ": " + temp);
	if (temp != null) {
		return temp;
	} else {
		return defaultVal;
	}
}

	function init() {
	// Executed only once, at startup
		dateArray = [];
		velArray = [];
		today = new Date();
		todayms = today.getTime();
		coords = {x:0, y:0};
		fact = 1;

		bodyID = "[bodyID_no_init]";
		bodyName =  "[bodyName_no_init]";
	  	bodyRadius =  "[bodyRadius_no_init]";

		paramBodyId = getParam("body","[missing BODY param]");
		if (paramBodyId == "[missing BODY param]") {
			paramBodyId = getParam("center","[missing CENTER param]");
		}
		paramBodyName = getParam("bodyname","[missing BODYNAME param]");
		paramBodyRadius = getParam("radius","[missing RADIUS param]");
		paramOrbiterId = getParam("orbiter","[missing ORBITER param]");
		paramOrbitername = getParam("orbitername","[missing ORBITERNAME param]");
		paramSiteLat = getParam("lat","0");
		paramSiteLon = getParam("lon","0");
		paramSiteAlt = getParam("alt","0");
		paramStartDate = getParam("start","[missing START param]");
		paramStopDate = getParam("stop","[missing STOP param]");
		paramTimeStep = getParam("step","1d");
		param3dRangeX = getParam("3dx","[missing 3dx param]");
		param3dRangeY = getParam("3dy","[missing 3dy param]");
		param3dRangeZ = getParam("3dz","[missing 3dz param]");
		param3dZoom  = getParam("3dzoom","[missing 3dzoom param]");
		
		ZoomLevel3d = param3dZoom;


		fillLinks();

		orbiterIndex = -1;
		for (var index = 0; ((index <orbiterIDs.length) && (orbiterIndex == -1)); index++) {
			if (paramOrbiterId == orbiterIDs[index].id) {
				orbiterIndex = index;
				orbiterID = orbiterIDs[index].id;
				orbiterName = orbiterIDs[index].name;
console.log("FOUND:"+paramOrbiterId + "=" +orbiterIDs[index].name);
			}
		}
		if (orbiterIndex== -1) {
			orbiterID = paramOrbiterId;
        	orbiterName = paramOrbitername;
		}


		////// Calcoli rispetto  a punto preciso su superficie
		if (paramBodyId.indexOf("coord") >= 0) {
			bodyID = paramBodyId;     		// Significative
			bodyName = paramBodyName; 		// Accessory
		  	bodyRadius = paramBodyRadius*1; // Accessory
			appendCoords = "&COORD_TYPE=%27GEODETIC%27&SITE_COORD=%27" + paramSiteLon + "," +  paramSiteLat + "," +  paramSiteAlt + "%27";
console.log("CUSTOM SITE: " + appendCoords);
		} else {
		/////// Calcoli rispetto a centro del corpo
			appendCoords = "";
			bodyIndex = -1;
console.log("orbiterIDs",orbiterIDs);
console.log("bodyIndex",bodyIndex);
			for (var index = 0; ((index <bodyIDs.length) && (bodyIndex == - 1)); index++) {
console.log(index);
console.log(bodyIDs[index]);
				if (paramBodyId === bodyIDs[index].id) {
					///// Corpo celeste presente nel database interno
					bodyIndex = index;
					bodyID = bodyIDs[bodyIndex].id;  // "CENTER"
					bodyName = bodyIDs[bodyIndex].name;
					bodyRadius = bodyIDs[bodyIndex].radius * 1.0;
					if ((paramBodyRadius != null) && (paramBodyRadius*1>0) && (paramBodyRadius !== "[missing RADIUS param]")) {
						bodyRadius = paramBodyRadius*1.0; // user can override default radius to specify landing site radius/altitude
					} else {
							//
					}
console.log("Ok, body " + bodyID + " known, it is " + bodyName + "; default radius= " + bodyIDs[bodyIndex].radius*1 + ", override radius=" + paramBodyRadius + ", assigned radius = " + bodyRadius);
				} else {
                ///// Corpo celeste NON presente nel database interno
					bodyName = paramBodyName; // Opzionale
					if (paramBodyRadius != "[missing RADIUS param]") {
						bodyRadius = paramBodyRadius*1.0; // user can override default radius to specify landing site radius/altitude
					} else {
                        bodyRadius = 1.0;
					}
				}
			} // Fine ciclo di ricerca paramBodyId in database interno
			if(bodyIndex == -1) {
				bodyName = paramBodyName;
                bodyID = paramBodyId;
				if ((paramBodyRadius != null) && (paramBodyRadius>0) && (paramBodyRadius != "[missing RADIUS param]")) {
					bodyRadius = paramBodyRadius*1.0; // user can override default radius to specify landing site radius/altitude
				} else {
					//
				}
console.log("Warning: center body not in internal db<br>Please specify body radius in url (param 'radius') to get meaningful altitude data; currently specified: " + paramBodyRadius);
			} else {
console.log("CONFERMATO: Ok, body " + bodyID + " known, it is " + bodyName);
				if ((paramBodyRadius != null) && (paramBodyRadius>0) && (paramBodyRadius != "[missing RADIUS param]")) {
					bodyRadius = paramBodyRadius*1.0; // user can override default radius to specify landing site radius/altitude
				} else {

				}
			}
		}

	if (bodyRadius*1.0>0) {
		factor = bodyRadius*1.0;
	} else {
		factor = 100;
		console.log("BODY RADIUS MISSING, SETTING TO 100");
	}

	// Resize sphere according to body radius:
	sphereMeshData.x = sphereA.map(x => x * factor);
	sphereMeshData.y = sphereB.map(x => x * factor);
	sphereMeshData.z = sphereC.map(x => x * factor);

		trace3d = { // Orbiter trajectory
		  x:[],  y: [], z: [],
		  text: [],
		  mode: 'lines+markers',
		  marker: {
		    size: 3,
		    line: {
		      color: 'rgba(217, 217, 217, 0.14)',
		      width: 0
		    },
		    opacity: 0.8
		  },
		  type: 'scatter3d',
		  name: "Position"
		};


		trace2d_Before = { // 2d chart
		  x:[],  y: [],
		  mode: 'lines+markers',
	    line: {
	      width: 1
	    },
		  marker: {
		    size: 1,
		    opacity: 1
		  },
		  type: 'scatter',
		  name: "Altitude before today"
		};


		trace2d_After = { // 2d chart
		  x:[],  y: [],
		  mode: 'lines+markers',
	    line: {
				dash: 'dash',
	      width: 1
	    },
		  marker: {
		    size: 1,
		    opacity: 1,
            		  },
		  type: 'scatter',
		  name: "Altitude after today"
		};

		trace2d_edges = { // 2d chart; invisible points to fix range
		  x:[],  y: [],
		  mode: 'lines',
	    line: {
				dash: 'dash',
	      width: 0
	    },
		  type: 'scatter',
		  name: ""
		};




		trace3d_today = { // Single point for today position
		  x:[],  y: [], z: [],
		  mode: 'markers',
		  marker: {
		    size: 5,
		    color: ['rgb(0, 0, 0)'	],
		    symbol: 'sphere',
		    line: {
		      color: 'rgba(0, 0, 0)',
		      width: 3
		    },
		    opacity: 1
		  },
		  type: 'scatter3d',
		  name: "Today position"
		};

		trace2d_today = { // Single point for today position in 2d chart
		  x:[],  y: [],
		  mode: 'markers',
		  marker: {
		    size: 4,
		    color: ['rgb(0, 0, 0)'	],
		    symbol: 'sphere',
		    line: {
		      color: 'rgba(0, 0, 0)',
		      width: 3
		    },
		    opacity: 1
		  },
		  type: 'scatter',
		  name: "Today position"
		};


		// Define chart layout:
		layout = {
				scene:{
					hoverinfo: "text",
					aspectmode: "data",
					aspectratio: {
						x: 1, y: 1, z: 1,
					},
					xaxis: {
						nticks: 10,
						autorange: true//range: [-10, 10],
					},
					yaxis: {
						nticks: 10,
                        range: [-10, 10],
						autorange: true  //range: [-10, 10], //override?
					},
					zaxis: {
						nticks: 10,
						autorange: true//range: [-10, 10],
					}					
				}
		  };

		layout2d = {
		  		title: "Altitude (km)",
				margin: { // To leave X-ticks visible when they get vertical
				    b: 150,
				    pad: 4
				  },
				xaxis: {
				    tickfont: {
				      size: 9
				    },
					autorange: true,
					showgrid: true,
					//range: [-50, 50],
					zeroline: true,
					showline: true,
					autotick: true,
					ticks: '',
					showticklabels: true
				},
				yaxis: {
				    tickfont: {
				      size: 9
				    },
					autorange: true,
					//range: [0, 1],
					showgrid: true,
					zeroline: true,
					showline: true,
					autotick: true,
					ticks: '',
					showticklabels: true
				}
			}

	}

function preLoad() {
// First run is with fake dates, just to retrieve file containing available last date
console.log("Preloading data for:");
console.log("bodyID");
console.log(bodyID);
console.log("orbiterID");
console.log(orbiterID);
 	if ( ((bodyID == "") && (orbiterID =="")) || (showHelp == true)) {
console.log("BODY o CENTER non definito."); 	
		showHelp = false;
		fullURL = BASE_HORIZONS_URL + "&COMMAND=%27*%27&CENTER=%27@%27"; // Download list of bodies
		finalURL = LOCAL_PROXY +  encodeURIComponent(fullURL);
		var clientMissingData = new XMLHttpRequest();
		clientMissingData.open('GET',  finalURL);

	    clientMissingData.onprogress = function(event) {
	  		showDownloadProgress(clientMissingData.response.length);
		};

		clientMissingData.responseType = 'text';
		clientMissingData.onload = function() {
console.log("### PRELOAD 001ok - Risposta ricevuta per lista oggetti");
			objectsList = clientMissingData.response; // Load remote response.;
			document.getElementById("status").innerHTML = "Nothing specified, click links  or check objects list below<br>";
			fillLinks()
			document.getElementById("trackedTitle").innerHTML += clientMissingData.response.replace(/\n/g, "<br />");
		}
	    clientMissingData.onerror = function(event) {
			console.log("***** PRELOAD 001err -  NETWORK ERROR while loading objects list**");
	  		document.getElementById("status").innerHTML = "** NETWORK ERROR  while loading objects list**";
		};
console.log("### PRELOAD 001send");
		clientMissingData.send(); // Async connection to data server.
	} else { // BODY e ORBITER specificati, ok:
		showHelp = false;
		fullURL = BASE_HORIZONS_URL;  //"https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1";
		fullURL += "&COMMAND=%27" + orbiterID + "%27"; // -152 = Chandrayaan2
		fullURL += "&CENTER=%27" + bodyID + "%27"; // 301 = Moon
		fullURL += "&START_TIME=%270000-00-00 00:00%27"; // Dummy dates just to retrieve file header containing real dates
		fullURL += "&STOP_TIME=%270000-00-00 00:00%27";
		fullURL += "&STEP_SIZE=%271 h%27";
		fullURL += "&MAKE_EPHEM=%27YES%27";
		fullURL += "&TABLE_TYPE=%27VECTORS%27";
		fullURL += "&OUT_UNITS=%27KM-S%27";
		fullURL += "&REF_SYSTEM=%27J2000%27";
		fullURL += "&VEC_LABELS=%27YES%27";
		fullURL += "&CSV_FORMAT=%27YES%27";
		fullURL += "&OBJ_DATA=%27YES%27";
		fullURL += "&VEC_TABLE=%273%27";
		document.getElementById("status").innerHTML = "Checking available dates for " + orbiterID + "(" + orbiterName + ") around " +  bodyID + "(" + bodyName + ")...";
		document.getElementById("lnkResults").innerHTML = '<a href="' +fullURL + '">Link to raw data</a> from <a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi">NASA Horizons site</a>';


		finalURL = LOCAL_PROXY +  encodeURIComponent(fullURL);

		var clientPreload = new XMLHttpRequest();
		clientPreload.open('GET',finalURL);

	    clientPreload.onprogress = function(event) {
	  		showDownloadProgress(clientPreload.response.length);
		};

		clientPreload.responseType = 'text';
		clientPreload.onload = function() {
console.log("### PRELOAD 002ok - Risposta ricevuta");
 			if ((bodyID == "") && (orbiterID =="")) {
 				document.getElementById("status").innerHTML = "List of available codes<br>";
				fillLinks();
 				document.getElementById("trackedTitle").innerHTML +=  clientPreload.response.replace(/\n/g, "<br />");
 			} else {
				document.getElementById("status").innerHTML = "First data received, extracting last dates..."
				ephemeris = clientPreload.response; // Load remote response.
				if (checkErrors(ephemeris) <0 ) {
console.log("****PRELOAD - Errore 001 in file ricevuto, ritorno...");				
					return(-1);
				}
				extractDates(); // Extract last dates from file
				document.getElementById("status").innerHTML = "Processing data..."
				ephemeris= "niente";
				loadRealData("first_start");
			}
		};
	    clientPreload.onerror = function(event) {
			console.log("**** PRELOAD 002err -  NETWORK ERROR while preloading data**");
	  		document.getElementById("status").innerHTML = "** NETWORK ERROR while preloading data**";
		};
console.log("### PRELOAD 002send- Invio richiesta a " + finalURL + " ...");
		clientPreload.send(); // Async connection to data server.
	}
}



function checkErrors(ephemeris) {
	if (( ephemeris.indexOf("No ephemeris for") >= 0)  || (ephemeris.indexOf("No matches found") >= 0) ){
		startPos=ephemeris.indexOf("No ephemeris for");
		endPos=ephemeris.indexOf("\n",startPos+1);
		errorLength = endPos - startPos +1
		errorString = ephemeris.substr(startPos, errorLength);
		document.getElementById("status").innerHTML = "FILE ERROR";
		document.getElementById("trackedTitle").innerHTML = 'Error: ' + errorString + '<br>Check errors in <a href="' + fullURL + '">received file</a><br>Parameters specified:<br>Start date: ' + paramStartDate + "<br>Stop date: " + paramStopDate + "<br>Timestep: " + paramTimeStep;
		console.log('********** Errore 002 in file dati: ' + errorString);
		console.log("File error, esco");
		return(-1);
	} else {
	}
}


//	{id: "-9901491",    name: "Tianwen-1"},
//	{id: "-168",    name: "Mars2020"},
//	{id: "-62",    name: "Hope"},


function fillLinks() {
	document.getElementById("lblLinks").innerHTML = "";
	SpiritLink = '<a href="space-explorer-tracker.html?orbiter=-254&body=@499&start=2004-01-04 4:15&stop=2004-01-04 4:25&step=200&radius=3401.1857&3dzoom=5000">Spirit MER EDL</a>';
	OpportunityLink = '<a href="space-explorer-tracker.html?orbiter=-253&body=@499&start=2004-01-25 4:44&stop=2004-01-25 4:54&step=200&radius=3400.898&3dzoom=5000">Opportunity MER EDL</a>';
	PhoenixLink = '<a href="space-explorer-tracker.html?orbiter=-84&body=@499&start=2008-05-25 23:28&stop=2008-05-25 23:38&step=200&radius=3380&3dzoom=5000">Phoenix EDL</a>'
	InsightLink = '<a href="space-explorer-tracker.html?orbiter=-189&body=@499&start=2018-11-26 19:35&stop=2018-11-26 19:45&step=200&radius=3395.456&3dzoom=5000">Insight EDL</a>';
	MSL_Link = '<a href="space-explorer-tracker.html?orbiter=-76&body=@499&start=2012-08-06 05:09:40&stop=2012-08-06 05:19:00&step=40&3dzoom=5000&radius=3391.136">MSL (Mars Science Laboratory) EDL</a>';
	MARS2020Link = '<a href="space-explorer-tracker.html?orbiter=-168&body=@499&start=2021-FEB-18 20:40&stop=2021-FEB-18 20:46&step=200&3dzoom=10000&radius=3392">MARS 2020 EDL</a>';
	HopeLink = '<a href="space-explorer-tracker.html?orbiter=-62&body=@499">Hope around Mars</a>';
	Tianwen1Link = '<a href="space-explorer-tracker.html?orbiter=-9901491&body=@499">Tianwen-1  around Mars</a>';
	//Hayabusa2link = '<a href="space-explorer-tracker.html?orbiter=-37&body=@162173&start=2019-2-21&stop=2019-2-22&step=10m">Hayabusa 2 around Ryugu</a>';
	Hayabusa2link2 = '<a href="space-explorer-tracker.html?orbiter=-37&body=@399&start=2019/11/1&stop=2020/12/20&step=30d&3dzoom=300000000">Hayabusa 2 back home</a>';
	osirisLink = '<a href="space-explorer-tracker.html?orbiter=-64&body=@2101955">Osiris-Rex around Bennu</a>';
	usageLink = 'Use this format for other explorers: <a href="www.example.com/space-explorer-tracker.html?body=XXXX&orbiter=YYYY&start=yyyy-mm-dd hh:mm&stop=yyyy-mm-dd hh:mm&step=xxxxd&3dzoom=1000000">space-explorer-tracker.html?body=XXXX&orbiter=YYYY&start=yyyy-mm-dd hh:mm&stop=yyyy-mm-dd hh:mm&step=xxxx&3dzoom=1000000</a><br>';
	document.getElementById("lblLinks").innerHTML = "Precompiled links:<br><UL>" 
	+ "<li>" + SpiritLink	
	+ "<li>" + OpportunityLink 
	+ "<li>" + PhoenixLink
	+ "<li>" + InsightLink
	+ "<li>" + MSL_Link
	+ "<li>" + MARS2020Link
	+ "<li>" + HopeLink
	+ "<li>" + Tianwen1Link
	+ "<li>" + osirisLink 
	+ "<li>" + Hayabusa2link2
	+ "</ul>"	
	+ usageLink + "<br><br>";
}



function isValidDate(d) {
  return d instanceof Date && !isNaN(d);
}



function loadRealData(caller) {
      downloadSuccess = false;
	// Once the empty data file has been downloaded and the real available dates extracted, update
	// the url to download the real data file:
	var clientRealData = new XMLHttpRequest();
	
	switch (caller) {
		case "first_start":
		case "form":
			fullURL = BASE_HORIZONS_URL; //"https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1";
			fullURL += "&COMMAND=%27" + orbiterID + "%27";
			fullURL += "&CENTER=%27" + bodyID + "%27";
			fullURL += "&START_TIME=%27" + START_DATE_chart  + "%27";
			fullURL += "&STOP_TIME=%27" + END_DATE_chart + "%27";
			fullURL += "&STEP_SIZE=%27" + TIME_STEP + "%27";
			fullURL += "&MAKE_EPHEM=%27YES%27";
			fullURL += "&TABLE_TYPE=%27VECTORS%27";
			fullURL += "&OUT_UNITS=%27KM-S%27";
			fullURL += "&REF_SYSTEM=%27J2000%27";
			fullURL += "&VEC_LABELS=%27YES%27";
			fullURL += "&CSV_FORMAT=%27YES%27";
			fullURL += "&OBJ_DATA=%27YES%27";
			fullURL += "&VEC_TABLE=%273%27";
			fullURL += appendCoords;
			break;
		case "add_plot1":
			// DEBUG
// 	{id: "-9901491",    name: "Tianwen-1"},
//	{id: "-168",    name: "Mars2020"},
//	{id: "-62",    name: "mars Hope"},
//	MARS HOPE: space-explorer-tracker.html?orbiter=-62&body=@499&start=2020-7-31&stop=2021-2-20&step=30d&3dzoom=100000000
console.log("Carico dati Mars 2020 da url manuale...");
			fullURL = BASE_HORIZONS_URL + "&MAKE_EPHEM=%27YES%27&TABLE_TYPE=%27VECTORS%27&OUT_UNITS=%27KM-S%27&REF_SYSTEM=%27J2000%27&VEC_LABELS=%27YES%27&CSV_FORMAT=%27YES%27&OBJ_DATA=%27YES%27&VEC_TABLE=%273%27&STEP_SIZE=%271d%27&START_TIME=%272020-7-31 23:7%27&STOP_TIME=%272021-2-20 23:7%27&COMMAND=%2785%27&CENTER=%27@499%27&";
			break;
		case "add_plot2":
			// DEBUG
// 	{id: "-9901491",    name: "Tianwen-1"},
//	{id: "-168",    name: "Mars2020"},
//	{id: "-62",    name: "mars Hope"},
//	MARS HOPE: space-explorer-tracker.html?orbiter=-62&body=@499&start=2020-7-31&stop=2021-2-20&step=30d&3dzoom=100000000
console.log("Carico dati Tianwen da url manuale...");
			fullURL = BASE_HORIZONS_URL + "&MAKE_EPHEM=%27YES%27&TABLE_TYPE=%27VECTORS%27&OUT_UNITS=%27KM-S%27&REF_SYSTEM=%27J2000%27&VEC_LABELS=%27YES%27&CSV_FORMAT=%27YES%27&OBJ_DATA=%27YES%27&VEC_TABLE=%273%27&STEP_SIZE=%271d%27&START_TIME=%272020-7-31 23:7%27&STOP_TIME=%272021-2-20 23:7%27&COMMAND=%27-168%27&CENTER=%27@499%27&";
			break;
		}

	document.getElementById("status").innerHTML = "Preparing new download URL...";
	document.getElementById("trackedTitle").innerHTML = ".";
	document.getElementById("lnkResults").innerHTML = '<a href="' +fullURL + '">Link to raw data</a> from <a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi">NASA Horizons site</a>';
	finalURL = LOCAL_PROXY + encodeURIComponent(fullURL);

	clientRealData.open('GET', finalURL);
	clientRealData.responseType = 'text';
console.log ("### LOADREALDATA 001send - Apro " + fullURL + "...(caller:" + caller + ")");
	clientRealData.send() // Async connection to data server.

	clientRealData.onload = function() {
		console.log("### LOADREALDATA 001ok - ONLOAD event. Processing....(caller:" + caller + ")");
		document.getElementById("trackedTitle").innerHTML = "--";
		document.getElementById("status").innerHTML = "Download completed";
		alert("Data download complete, click OK to process and plot (may take a while; data length: " + clientRealData.response.length + ")");
		document.getElementById("status").innerHTML = "Download completed";
		processData(clientRealData, caller);
	}

    clientRealData.onprogress = function(event) {
  		showDownloadProgress(clientRealData.response.length);
	};

    clientRealData.onloadend = function(event) {
		//console.log("### LOADREALDATA 001loadend - ONLOADEND event. Processing...");
  		//document.getElementById("trackedTitle").innerHTML = "---";
	};

    clientRealData.onerror = function(event) {
		console.log("*********LOADREALDATA 001err -  NETWORK ERROR  while downloading full data **(caller:" + caller + ")");
		document.getElementById("status").innerHTML = "** NETWORK ERROR while downloading full data **";
	};
}

function showDownloadProgress(L) {
	progressStatusIndex++;
	if (progressStatusIndex >= PROGRESS_SYMBOLS_COUNT) {
		progressStatusIndex=0;
	}
  	document.getElementById("status").innerHTML = "Downloading... " + L;// + " - " + progressStatusArray[progressStatusIndex];
}



function processData(client2, caller) {
	ephemeris = client2.response; // Load remote response.
console.log("Final data acquired: " + ephemeris.length + " bytes, caller=", caller);
	document.getElementById("status").innerHTML = "Final data acquired";

	if (checkErrors(ephemeris) < 0 ) {
		document.getElementById("status").innerHTML = "ERROR 003";
		console.log("ERROR 003 on url:", finalUrl)
		return(-1);
	} else {
		console.log("Ephemeris looks ok...");
	}

	// Estrae solo tabella dati:
	dataStart = ephemeris.indexOf("$$SOE")+6;
	dataEnd = ephemeris.indexOf("$$EOE")-1;
	dataLength = dataEnd - dataStart + 1
	try {
		onlyData = ephemeris.substr(dataStart, dataLength)
	} catch (err) {
		console.log("### ERROR 001 ### :" , err);
		console.log("Used url:" , decodeURIComponent(fullURL));
		console.log("Raw data:", ephemeris);
        document.getElementById("status").innerHTML = "Error 001 in downloaded data, cannot plot";
		return;
	}

console.log("Lunghezza dati: ", onlyData.length);

	if (onlyData.length*1 <= 0) {
		console.log("### ERROR 002 ### No valid data for url:" , decodeURIComponent(fullURL));
		console.log("Raw data:", ephemeris);
        document.getElementById("status").innerHTML = "Error 002 in downloaded data, cannot plot";
		return;
	}

// Pre-plot to allow realtime plotting:
/////////////////////////
//	layout2d.xaxis.autorange=false;
//	layout2d.yaxis.autorange=false;
	traces2d = [trace2d_Before, trace2d_After/*, trace2d_today*/];
    chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);

	traces3d = [trace3d, trace3d_today, sphereMeshData];
	chart3d = Plotly.newPlot('myDiv', traces3d, layout)

	console.log("Preplot completed.");
//////////////////////////




	// Clear "please wait" status label:
	if (orbiterName != "[missing ORBITERNAME param]") {
		orbiterNameShown = "(" + orbiterName +  ")" ;
	} else {
        orbiterNameShown = "";
	}

	if (bodyName != "[missing BODYNAME param]") {
		bodyNameShown = "(" + bodyName +  ")" ;
	} else {
        bodyNameShown = "";
	}

	document.getElementById("status").innerHTML = orbiterID + orbiterNameShown + " around " + bodyID + bodyNameShown;

	if (bodyRadius == "[missing RADIUS param]") {
		document.getElementById("trackedTitle").innerHTML = "Warning: center body not in internal db<br>Please specify body radius in url (param 'radius') to get meaningful altitude data.";
	}




	// Riempie tabella per excel italiano (virgole al posto dei punti):

	// Elimina stupidaggini:
	italianTable = onlyData.replaceAll(" A.D. ","");
	italianTable = italianTable.replaceAll(".0000","");

	italianTable = italianTable.replaceAll(",","\t"); // Tabulazioni al posto delle virgole
	italianTable = italianTable.replaceAll(".",","); // Virgole al posto dei punti decimali

console.log("Tabella finale ", italianTable.length);

	// Rimepie textarea con dati da copiare in excel:
	document.getElementById("excel1").innerHTML = italianTable;

	// Extract data:
	ephStart = ephemeris.indexOf("$$SOE") + 7;
	ephLinesEnd = ephemeris.indexOf("$$EOE") - 1;
	ephLinesLength = ephLinesEnd - ephStart;
	ephLines =  ephemeris.substr(ephStart,ephLinesLength);
	ephLinesArray = ephLines.split("\n");

	// Init data arrays:
	chartPoints3d = {x:[],y:[],z:[]};
	chartPoints2d = {x:[],y:[]};
	chartPoints2dAfter = {x:[],y:[]};
	labels = [];

	TIME_STEP_min = convertTimestepToMinutes(TIME_STEP, null, null);

	// Suddivide i dati in array separati:
	for (var lineIndex=0; lineIndex < ephLinesArray.length; lineIndex++) {
		ephLinesArray[lineIndex] = ephLinesArray[lineIndex].replace(" A.D. ","");
		ephLinesArray[lineIndex] = ephLinesArray[lineIndex].replace(".0000","");

		lineData = ephLinesArray[lineIndex].split(",");
        lineDataArray.push(lineData);

		// Extract positions:
		xposArray.push(lineData[2]*1.0/fact);
		yposArray.push(lineData[3]*1.0/fact);
		zposArray.push(lineData[4]*1.0/fact);
		dist = lineData[9]*1.0/fact;
		distancesArray.push(dist);
		speedArray.push(lineData[10]*1.0/fact);

		// Store min/max distances
		if (dist > maxDist) maxDist = dist;
		if (dist < minDist) minDist = dist;


		/////// Store position for dot representing today ////////
		// Extract position date:
		dateNow = lineData[1];

		// Convert date into ms to compare to current time and plot the circle representing it:
		plottedDate = new Date(dateNow);
		plottedDatems = plottedDate.getTime();

		if (!TODAY_VISIBLE) {
			if ((plottedDatems - TIME_STEP_min*MSperMinute < todayms) && (todayms < plottedDatems + TIME_STEP_min*MSperMinute ) ){
				TODAY_VISIBLE = true;

				trace3d_today.x.push(lineData[2]*1.0/fact); // Current date
				trace3d_today.y.push(lineData[3]*1.0/fact);
				trace3d_today.z.push(lineData[4]*1.0/fact);
				trace3d_today.marker.color.push('rgba(0, 0, 0, 1)'); // opaco

				trace2d_today.x.push(dateNow); // Current date
				trace2d_today.y.push(dist-bodyRadius);
				trace2d_today.marker.color.push('rgba(0, 0, 0, 1)'); // opaco

			} else {
				//
			}
		}
		//////////////////////////////////////////////////////


	}


	// Memorizza punti estremi del grafico, per pre-tracciarlo con i range X-Y giusti:
	for (var a=0; a < lineDataArray.length; a++) {
	    trace2d_edges.x.push(lineDataArray[a][1]); // Memorizza tutte le date sulle ascisse
    	trace2d_edges.y.push(maxDist/fact - bodyRadius); // Memorizza (temporaneamente) sempre l'altezza massima
		if (a === 0) {
	    	trace2d_edges.y.push(maxDist/fact - bodyRadius);
		}
		if (a === 1) { // Nel secondo punto memorizza l'altezza minima
	    	trace2d_edges.y.push(minDist/fact - bodyRadius);
		}
	}


	// Pre-traccia grafico con soli punti estremi, per fissare i range di X e Y:
    traces2d = [trace2d_Before, trace2d_After/*, trace2d_today*/, trace2d_edges];
	chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);

    // Traccia grafico in tempo reale:
	intervalPlot = setInterval(function() {
		intervalPlotIndex++;
		if ( intervalPlotIndex < ephLinesArray.length) {
			intervalAddPoint(intervalPlotIndex, caller);
		} else  {
console.log("Fine punti");
			document.getElementById("status").innerHTML = orbiterID + orbiterNameShown + " around " + bodyID + bodyNameShown;
			clearInterval(intervalPlot);

			traces2d = [trace2d_Before, trace2d_After, trace2d_today];
		    chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);

			// Store main data into chart:
		  	trace3d.x = chartPoints3d.x;
			trace3d.y = chartPoints3d.y;
			trace3d.z = chartPoints3d.z;
		  	trace3d.text = labels;
		  	trace3d.hoverinfo = "text"; // Rimuovi "x,y,z" di default da etichette

			trace3d_today.text = labels;

			traces3d = [trace3d, trace3d_today, sphereMeshData];
			chart3d = Plotly.newPlot('myDiv', traces3d, layout)
		}
	}, 100);

}



function intervalAddPoint(i, caller) {
		// Parse results and store into data arrays

		document.getElementById("status").innerHTML = "Plotting " + (100*i/ephLinesArray.length).toFixed(0) + "%...";

		// Extract positions:
		xpos = xposArray[i]; 
		ypos = yposArray[i]; 
		zpos = zposArray[i]; 
		dist = distancesArray[i];
		speed = speedArray[i]; 

		// Extract position date:
		dateArray[i] = lineDataArray[i][1];

		// Store positions:
		chartPoints3d.x.push(xpos);
		chartPoints3d.y.push(ypos);
		chartPoints3d.z.push(zpos);

		// Convert date into ms to compare to current time and plot the circle representing it:
		plottedDate = new Date(dateArray[i]);
		plottedDatems = plottedDate.getTime();

		// Different color of 2d track depending on before/after today
		if ((plottedDatems - TIME_STEP_min*60000 <= todayms) ) {
			trace2d_Before.x.push(dateArray[i]);
			trace2d_Before.y.push(dist-bodyRadius);
			trace2d_After.x.push();
			trace2d_After.y.push();
		} else {
			trace2d_Before.x.push();
			trace2d_Before.y.push();
			trace2d_After.x.push(dateArray[i]);
			trace2d_After.y.push(dist-bodyRadius);
		}

		// Store position date:
		if ( isNaN(xpos) || isNaN(ypos) || isNaN(zpos) || isNaN(dist) || isNaN(bodyRadius) ) {
			labels.push("Pos: " + i + ", Date: " + dateArray[i] + "<br>Alt. unknown, pls specify body radius");
		} else {
			rawAlt = Math.sqrt(xpos*xpos+ypos*ypos+zpos*zpos)-bodyRadius;
			labels.push(dateArray[i] + "<br>Alt. " + formatNumber(rawAlt.toFixed(0)) + " (Center dist. "  + formatNumber(dist.toFixed(0))  + ") km<br>Pos: " + i);
		}


	// Commit data to chart
	switch (caller) {
		case "first_start":
		case "form":
			// Chiamata la prima volta, all'apertura della pagina: carica solo il grafico specificato dall'url
			// Chiamata anche su pressione del pulsante dopo il riempimento della form coi parametri del primo grafico
			if (TODAY_VISIBLE) {
				traces3d = [trace3d, trace3d_today];
				traces2d = [trace2d_Before, trace2d_After, trace2d_today];
//alert(trace2d_today.x[0]);
			} else {
				traces3d = [trace3d];
				traces2d = [trace2d_Before, trace2d_After];
			}
			break;
		case "add_plot":
console.log("Aggiungo direttamente da url scritto a mano dentro alla pagina");
			traces3d.push(trace3d);
			traces3d.push(trace3d_today);
			break;
	}
	actualPlotting(caller);
}



function actualPlotting(caller){
	switch (caller) {
		case "first_start":
		case "form":
			// Plot data:
            //set3dZoom(maxDist*2);
            Plotly.redraw('myDiv2');

			break;
		case "add_plot1":
			storeLayout = layoutCopy(document.getElementById("myDiv")._fullLayout);
			chart3d = Plotly.newPlot('myDiv', traces3d, storeLayout);
            set3dZoom(maxDist*2);
			layoutPaste(storeLayout);
			chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);
			break;
	}

	

	if (caller == "add_plot1") {

	} else {
		if(ZoomLevel3d != "[missing 3dzoom param]") {
//			set3dZoom(ZoomLevel3d); // debug per ora non va...
		} else {
//            set3dZoom(maxDist);
		}
	}
}



function layoutCopy(layout) {
	cameraCenter = layout.scene.camera.center;
	cameraEye = layout.scene.camera.eye;
	cameraUp = layout.scene.camera.up;
	return {"center" : cameraCenter, "eye" : cameraEye, "up" : cameraUp};
}


function layoutPaste(layout) {
	console.log("Prima: ", layout);
	var update = {
		scene:{
			camera: {
				center: layout.center,
				eye: layout.eye,
				up: layout.up
			}
		}
	};
	gd = document.getElementById("myDiv");
	Plotly.relayout(gd, update);
	console.log("DOPO: ", gd._fullLayout);
}


function showCurrentZoom() {
	gd = document.getElementById("myDiv");
	prevXrange = gd._fullLayout.scene.xaxis.range;
	prevYrange = gd._fullLayout.scene.yaxis.range;
	prevZrange = gd._fullLayout.scene.zaxis.range;
	console.log("Camera center: ", gd._fullLayout.scene.camera.center);
	console.log("Camera eye: ", gd._fullLayout.scene.camera.eye);
	console.log("Camera up: ", gd._fullLayout.scene.camera.up);
	console.log("X axis: ", gd._fullLayout.scene.xaxis.range);
	console.log("Y axis: ", gd._fullLayout.scene.yaxis.range);
	console.log("Z axis: ", gd._fullLayout.scene.zaxis.range);
}



function set3dZoom(x1, y1, z1) {
	previousZoomSet = true;
	gd = document.getElementById("myDiv");
	prevXrange = gd._fullLayout.scene.xaxis.range;
	prevYrange = gd._fullLayout.scene.yaxis.range;
	prevZrange = gd._fullLayout.scene.zaxis.range;
	var update = {
		scene:{
			xaxis: {range:[-x1, x1] },
			yaxis: {range:[-x1, x1] },
			zaxis: {range:[-x1, x1] },
			aspectmode: "cube"
		}
	};
	Plotly.relayout(gd, update);
}




function resetZoom() {
	if (previousZoomSet) {
		set3dZoom(prevXrange, prevYrange, prevZrange)
	}
}



function tableSelect(tableIndex) {
console.log("seleziono");
    document.getElementById(tableIndex).focus();
	document.getElementById(tableIndex).setSelectionRange(0, document.getElementById(tableIndex).value.length);
    document.getElementById(tableIndex).select();
    if (document.execCommand('copy')) {
		alert("Copied to clipboard")
	} else {
		alert("Failed to copy text to clipboard");
	}

}

function extractDates() {
		// Extract last available dates from last line in the data file:
		/*
			Chandrayaan 2:
			ch2o_spk_190722-[190810_od0*]_v*_dsn.V0.* 2019-Jul-22 09:31 2019-Aug-30 05:00
			********************************************************************************

			OSIRIS REX:
			  Trajectory name                                   Start (TDB)    Stop (TDB)
			  ----------------------------------------------    -----------   -----------
			  orx_160908_231024_pgaa3_day06m60_v1               2016-Sep-08   2016-Sep-09
			*******************************************************************************




			  Trajectory files (from JPL Navigation)       Start                End
			  --------------------------------------  -----------------  -----------------
			  m2020_traj_ops_od002v1.V0.1             2020-Jul-30 12:53  2020-Jul-31 19:01
			  m2020_traj_ops_od016v1_AL123.V0.1       2020-Jul-31 19:01  2021-Feb-21 00:00
			*******************************************************************************

		*/


	startDashesLine = ephemeris.indexOf(markerFileNameFieldLength); // Start of line with dashes
	endDashesLine = ephemeris.indexOf("\n", startDashesLine+5);
	dashesLineLength = endDashesLine - startDashesLine;
	dashesLineContents = ephemeris.substr(startDashesLine, dashesLineLength);

	startDashesFilename = 1;
	endDashesFilename = dashesLineContents.indexOf(" ", startDashesFilename+5);
	filenameFieldLength = endDashesFilename - startDashesFilename; // Including beginning end ending spaces


	startDashesStartDateTemp = dashesLineContents.indexOf(" ", filenameFieldLength); // First space after dashes for name
	startDashesStartDate = dashesLineContents.indexOf("-", startDashesStartDateTemp); // First dash after space.
	endDashesStartDate = dashesLineContents.indexOf(" ", startDashesStartDate + 1); // First spaces after dashes for startdate
	startDateFieldLength = endDashesStartDate - startDashesStartDate;

	startDashesStopDateTemp = dashesLineContents.indexOf(" ", 1 + filenameFieldLength + startDateFieldLength); // First space after dashes for name
	startDashesStopDate = dashesLineContents.indexOf("-", startDashesStopDateTemp); // First dash after space.
	endDashesStopDate = dashesLineContents.length;
	stopDateFieldLength = endDashesStopDate - startDashesStopDate;


	
	datesStartMarker = ephemeris.toUpperCase().indexOf("SPACECRAFT TRAJECTORY");
	if (datesStartMarker < 0) {
		datesStartMarker = ephemeris.toUpperCase().indexOf("----------");
	}
	
console.log("--------------datesStartMarker",datesStartMarker);	
	endOfDatesList = ephemeris.indexOf("******" /*markerAsterisks*/, datesStartMarker/*startDashesLine*/); // Beginning of asterisks line after dates/files list	
console.log("--------------endOfDatesList",endOfDatesList);	
	lastDateLineStartTemp = endOfDatesList - MAXLEN - MAXLEN/2; // Go back 1.5 lines (all lines are max 80 characters long)
	lastDateLineStart = ephemeris.indexOf("\n", lastDateLineStartTemp) ; // Next new line SHOULD be beginning of last line...
	lastDateLineEnd = ephemeris.indexOf("\n", lastDateLineStart + 1);
	lastDateLineLength = lastDateLineEnd - lastDateLineStart;
	lastDateLineContents = ephemeris.substr(lastDateLineStart, lastDateLineLength);

	EpheFilename = lastDateLineContents.substr(0, filenameFieldLength);
	startDateString = lastDateLineContents.substr(startDashesStartDate, startDateFieldLength);
	stopDateString = lastDateLineContents.substr(startDashesStopDate, stopDateFieldLength);


	START_DATE_file = startDateString.replace(/^\s+|\s+$/g, ""); // Get rid of leading and trailing spaces - https://www.toptip.ca/2010/02/javascript-trim-leading-or-trailing.html
	END_DATE_file = stopDateString.replace(/^\s+|\s+$/g, ""); // Remove leading/trailing spaces.
	END_DATE_url = paramStopDate.replace(/^\s+|\s+$/g, ""); // Remove leading/trailing spaces.

	console.log("Start date in file", START_DATE_file);
	console.log("Stop date in file", END_DATE_file);
	console.log("Stop date in url", END_DATE_url);

	if (paramStartDate == "[missing START param]") {
console.log("Start date from file",START_DATE_file);
        START_DATE_data = START_DATE_file;
	} else {
		START_DATE_data = paramStartDate;
console.log("Sart date from URL",START_DATE_data);
	}



/*	if (paramStopDate == "[missing STOP param]") {
console.log("Stop date temporary taken from file, then will be set to tomorrow",END_DATE_file);
	} else {
		END_DATE_data = END_DATE_file;
console.log("End date from URL",END_DATE_data);
	}
*/


	if (paramTimeStep == "[missing STOP param]") { // TO DO: implement check for too many steps!
console.log("Default time step", TIME_STEP);
	} else {
		TIME_STEP = paramTimeStep;
console.log("Time step from URL",TIME_STEP);
	}

	// Today:
	dt = new Date();
	dt_ms= dt.getTime();

	if (!isValidDate(new Date(END_DATE_file))) {
		console.log("Invalid end date '" + END_DATE_file + ", using '" + START_DATE_data + "' + 1 day.");
		end_ms = dt_ms + 86400000;
		end_dt = new Date();
		end_dt.setTime(end_ms);
		END_DATE_file= end_dt.getFullYear()+ "-" + (end_dt.getMonth()+1) + "-" + end_dt.getDate() + " " + end_dt.getHours() + ":" + end_dt.getMinutes();
		console.log("New end date: " + END_DATE_file);
	}

	if (!isValidDate(new Date(START_DATE_data))) {
		console.log("Invalid start date '" + START_DATE_data + "', using 'today'.");
		START_DATE_data= dt.getFullYear() + "-" + (dt.getMonth()+1) + "-" +  dt.getDate() + " " + dt.getHours() + ":" + dt.getMinutes();
		console.log("New start date: " + START_DATE_data);
	}

	if (!isValidDate(new Date(END_DATE_data))) {
		console.log("Invalid end date '" + END_DATE_data + ", using '" + START_DATE_data + "' + 1 day.");
		end_ms = dt_ms + 86400000;
		end_dt = new Date();
		end_dt.setTime(end_ms);
		END_DATE_data= end_dt.getFullYear()+ "-" + (end_dt.getMonth()+1) + "-" + end_dt.getDate() + " " + end_dt.getHours() + ":" + end_dt.getMinutes();
		console.log("New end date: " + END_DATE_data);
	}


	START_DATE_chart_ms = new Date(START_DATE_data).getTime(); // Start chart from first valid date
	START_DATE_chart_temp= new Date(START_DATE_chart_ms);
	START_DATE_chart = START_DATE_chart_temp.getFullYear() + "-" + (START_DATE_chart_temp.getMonth()+1) + "-" +  START_DATE_chart_temp.getDate() + " "+  START_DATE_chart_temp.getHours() + ":" +  START_DATE_chart_temp.getMinutes();

	if (paramStopDate == "[missing STOP param]") {
		// Set tomorrow as default stop date:
console.log("No stop date provided, set to 1 day after start date");
		END_DATE_chart_ms = new Date(START_DATE_chart_ms+86400000) // End chart at first valid date plus 1 day
		END_DATE_chart_temp= new Date(END_DATE_chart_ms);
		END_DATE_chart = END_DATE_chart_temp.getFullYear()+ "-" + (END_DATE_chart_temp.getMonth()+1) + "-" + END_DATE_chart_temp.getDate() + " "+  END_DATE_chart_temp.getHours() + ":" +  END_DATE_chart_temp.getMinutes();
	} else {
		if (paramStopDate == "max") {
			// Set last available date as default stop date:
console.log("MAX stop date requested, set to file value");
			END_DATE_chart_ms = new Date(END_DATE_file)
			END_DATE_chart_temp= new Date(END_DATE_chart_ms);
			END_DATE_chart = END_DATE_chart_temp.getFullYear()+ "-" + (END_DATE_chart_temp.getMonth()+1) + "-" + END_DATE_chart_temp.getDate() + " "+  END_DATE_chart_temp.getHours() + ":" +  END_DATE_chart_temp.getMinutes();
		} else {
console.log("using stop date provided by URL");
			END_DATE_chart_ms = new Date(END_DATE_url)
			END_DATE_chart_temp= new Date(END_DATE_chart_ms);
			END_DATE_chart = END_DATE_chart_temp.getFullYear()+ "-" + (END_DATE_chart_temp.getMonth()+1) + "-" + END_DATE_chart_temp.getDate() + " "+  END_DATE_chart_temp.getHours() + ":" +  END_DATE_chart_temp.getMinutes();
		}
	}



console.log("Inizio dati:" , START_DATE_file);
console.log("Fine dati:", END_DATE_file);
console.log("Inizio grafico:",START_DATE_chart);
console.log("Fine grafico:",END_DATE_chart);

	document.getElementById("status").innerHTML = "Available dates extracted...";
	document.getElementById("txtStart").value = START_DATE_chart.replace(" "," ");
	document.getElementById("txtEnd").value = END_DATE_chart.replace(" "," ");
	document.getElementById("txtStep").value = TIME_STEP.replace(" "," ");
    document.getElementById("lblDates").innerHTML = "Calculated dates limits: " + START_DATE_file.replace(" "," ") + " - " + END_DATE_file.replace(" "," ")+ " - Outbound dates errors are not detected";
    document.getElementById("lblDates2").innerHTML = "Dates line in file: <b>" + lastDateLineContents + "</b>";
}


	function manualCalc() {
    	document.getElementById("status").innerHTML = "Processing...";
		START_DATE_chart = document.getElementById("txtStart").value.replace(" "," ");
		END_DATE_chart = 	document.getElementById("txtEnd").value.replace(" "," ");
		TIME_STEP = 	document.getElementById("txtStep").value;
		TIME_STEP_min = convertTimestepToMinutes(TIME_STEP, START_DATE_chart,END_DATE_chart);

		loadRealData("form");
	}
	
	
	function zoomChange2d(zoomLevel) {		
//console.log("zoomLevel", zoomLevel);
//console.log("prima", layout2d.yaxis.range[1]*1);
		layout2d.yaxis.range[1]=zoomLevel*1;
		//chart2d = Plotly.newPlot('myDiv2', chartPoints2d, layout2d);
        chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);
//console.log("dopo", layout2d.yaxis.range[1]);
	}


	function convertTimestepToMinutes(t, start, stop) {
		onlyNumber = t.substr(0,t.length-1) * 1.0;
		userUnit = t.substr(t.length-1,1);
//console.log("Timestep conv ",onlyNumber, userUnit);
		switch (userUnit) {
			case "m":
				resultInMinutes = onlyNumber;
				break;
			case "h":
				resultInMinutes = onlyNumber * 60;
				break;
			case "d":
				resultInMinutes = onlyNumber * 1440;
				break;
			default:
//console.log("Timestep conv: no unit, calculating... ");
				startMS = (new Date(start)).getTime();
				stopMS = (new Date(stop)).getTime();
				diffMS = stopMS - startMS;
				calculatedStepMS = diffMS/t;
				resultInMinutes / 60000;
//console.log("Timestep conv: result= ", resultInMinutes);
				//alert("Please specify timestep unit of measure (m, h or d)");
				//return -1;
				break;
		}
		return resultInMinutes * 1.0;
	}



function formatNumber(num) {
  return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1 ')
}



	$( document ).ready(
	 function() {
	 	document.getElementById("txtStart").value = START_DATE_chart.replace(" "," ");
	 	document.getElementById("txtEnd").value = END_DATE_chart.replace(" "," ");
		document.getElementById("txtStep").value = TIME_STEP;
		init(); // Init vars
		if (preLoad()<0) { // Load file with fake dates just to get available dates, then load real data
			console.log("****** Errore 000: precaricamento fallito");
			alert("Errore 000: precaricamento fallito, consultare file raw per dettagli");
			return -1;
		}

		$('#myDiv').on('ended',
		function(eventdata){
			var target = eventdata.target.layout;
			var yaixsrange=target.yaxis.range;
			var min = Math.round(yaixsrange[0]);
			var max = Math.round(yaixsrange[1]);
		console.log("***************MINIMO:",min);
		console.log("MASSIMO:",max);
		});

	}
	);

   </script>
   
	<center><big><big><strong>Space explorer tracker</strong></big></big><br>
	by Luca Cassioli 2018-2022<br>
	V. 5.1.0 - 08/MAR/2022<br>
	<i>Created with <a href="https://plot.ly/javascript/3d-charts/">plot.ly</a></i><br>
	<strong><big><big><big><span id="status" name="status">-76([noOrbiterName]) around @499(Mars)</span></big></big></big></strong></center><br>
	<span id="trackedTitle" name="trackedTitle">--</span><br>
	<span id="lblLinks2" name="lblLinks2"></span><br>
	<br>
	<center>
	<table>
	<tbody><tr>
	<td><div id="myDiv" style="width:600;height:600" class="js-plotly-plot"></div></td>
	<td><div id="myDiv2" style="width:600;height:600" class="js-plotly-plot"></div>
<!--Zoom:<button name="btnZoomAuto" id="btnZoomAuto" onclick="zoomChange2d('auto')">Auto</button>
<button name="btnZoomAsteroid" id="btnZoomAsteroid" onclick="zoomChange2d(0.1)">Asteroid (100m)</button>
<button name="btnZoomLanding1" id="btnZoomLanding1" onclick="zoomChange2d(3000)">Atmosphere entry 1 (3000 km)</button>
<button name="btnZoomLanding2" id="btnZoomLanding2" onclick="zoomChange2d(1000)">Atmosphere entry 2 (1000 km) </button><br>
-->

	</td>
	</tr>
	<tr>
	<td>Set 3d box width to <input type = "text" value = "100000" id="inp3dz" name="inp3dz">km  <button onclick="set3dZoom(inp3dz.value)">Go</button></td>
	<td><button onclick="layout2d.yaxis.autorange=false;layout2d.yaxis.range=[0,maxDist];chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);">Y origin = 0</button><button onclick="layout2d.yaxis.autorange=true;chart2d = Plotly.newPlot('myDiv2', traces2d, layout2d);">Autorange</button></td>
	</tr>
	</tbody></table>
	</center>
	<br>
	<span id="lnkResults" name="lnkResults"><a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1&amp;MAKE_EPHEM='YES'&amp;TABLE_TYPE='VECTORS'&amp;OUT_UNITS='KM-S'&amp;REF_SYSTEM='J2000'&amp;VEC_LABELS='YES'&amp;CSV_FORMAT='YES'&amp;OBJ_DATA='YES'&amp;VEC_TABLE='3'&amp;STEP_SIZE='1m'&amp;START_TIME='2012-8-6 5:10'&amp;STOP_TIME='2012-8-6 5:19'&amp;COMMAND='-76'&amp;CENTER='@499'&amp;">Link to raw data</a> from <a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi">NASA Horizons site</a></span><br>
	<span id="dates" name="dates"></span><br>
	Manual dates (yyyy-mm-dd HH:MM): <br>
	Start: <input type="text" id="txtStart" name="textStart" value="2012-8-6 5:10">  &nbsp; &nbsp; End: <input type="text" id="txtEnd" name="textEnd" value="2012-8-6 5:19"> &nbsp; &nbsp; Time step (*)
   <input type="text" id="txtStep" name="txtStep" value="1m"> &nbsp; &nbsp;
	<!--<button id="btnExtractDates" name="btnExtractDates" onclick="extractDates()">Latest dates</button><br>-->
	<button id="btnManual" name="btnManual" onclick="manualCalc()">Calculate</button><br>
	<span id="lblDates" name="lblDates">Calculated dates limits:  - 2021-1-22 13:19 - Outbound dates errors are not detected</span><br>
	<span id="lblDates2" name="lblDates2">Dates line in file: <b>
 od179_v1_eph-edl-landed               2012-Jun-26 18:00  2012-Aug-06 05:18</b></span><br>
	(*) use "10m" for 10 minute, "1h" for 1 hour, "1d" for 1 day,...<br>
	<br>
	List valid NASA Horizons code for bodies and spacecrafts: <a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1&amp;MAKE_EPHEM= 'YES'&amp;&amp;TABLE_TYPE= 'VECTORS'&amp;&amp;OUT_UNITS= 'KM-S'&amp;&amp;REF_SYSTEM= 'J2000'&amp;&amp;VEC_LABELS= 'YES'&amp;&amp;CSV_FORMAT= 'YES'&amp;&amp;OBJ_DATA= 'NO'&amp;&amp;VEC_TABLE= '2'&amp;&amp;STEP_SIZE= '1 h'&amp;&amp;START_TIME= '2018-09-1 00:00'&amp;&amp;STOP_TIME= '2018-12-03 17:01'&amp;&amp;COMMAND= '*'&amp;CENTER= '500@399'&amp;">LINK</a><br>
	<hr>
<br>
<br>
<span id="lblLinks" name="lblLinks"><a href="https://win98.altervista.org/space/exploration/3d/space-explorer-tracker.html?orbiter=-168&body=@499&start=2021-FEB-18 20:40&stop=2021-FEB-18 20:46&step=200&3dzoom=10000&radius=3392">MARS 2020 EDL</a><br>
<a href="https://win98.altervista.org/space/exploration/3d/space-explorer-tracker.html?orbiter=-62&amp;body=@499">Hope around Mars</a><br><a href="https://win98.altervista.org/space/exploration/3d/space-explorer-tracker.html?orbiter=-9901491&amp;body=@499">Tianwen-1  around Mars</a><br><a href="https://win98.altervista.org/space/exploration/3d/space-explorer-tracker.html?orbiter=-64&amp;body=@2101955">Osiris-Rex around Bennu</a><br><a href="https://win98.altervista.org/space/exploration/3d/space-explorer-tracker.html?orbiter=-37&amp;body=@399&amp;start=2019/11/1&amp;stop=2020/12/20&amp;step=30d&amp;3dzoom=300000000">Hayabusa 2 back home</a><br><br>Use this format for other explorers: <a href="https://win98.altervista.org/space/exploration/3d/www.example.com/space-explorer-tracker.html?body=XXXX&amp;orbiter=YYYY&amp;start=yyyy-mm-dd hh:mm&amp;stop=yyyy-mm-dd hh:mm&amp;step=xxxxd&amp;3dzoom=1000000">www.example.com/space-explorer-tracker.html?body=XXXX&amp;orbiter=YYYY</a><br></span><br>

<big><strong>USAGE</strong></big><br>
Please specify in URL:<br>
body: NASA Horizons  code for main body<br>
orbiter: NASA Horizons  code for orbiter<br>
start: yyyy/mm/dd HH:MM - start date with optional time<br>
stop:  yyyy/mm/dd HH:MM - stop date with optional time<br>
step: time step in minutes, hours or days depending on final letter (11d= 11 	days); no letter = number of samples between dates<br>
3dzoom: size of 3d chart in kilometers<br>
radius: planet radius in km<br>
<b>Example</b>:<br>
Show orbits for Insight around Mars:<br>
https://www.example.com/space-explorer-tracker.html?body=499&amp;orbiter=-189&amp;start=2010-10-1
 10:10&amp;stop=2010-10-2 12:00&amp;step=1d<br>
<br>
List of codes: <a href="https://ssd.jpl.nasa.gov/horizons_batch.cgi?batch=1&amp;COMMAND='*'&amp;CENTER='@*'">link</a><br>
NASA Horizons web interface: <a href="https://ssd.jpl.nasa.gov/horizons.cgi?show=1#results">link</a><br>
<br>
	<hr><br>
	Horizons parameters:<br>
	VEC_TABLE=<br>
	1: X, Y, Z<br>
	2: X, Y, Z, VX, VY, VZ<br>
	3: X, Y, Z, VX, VY, VZ, LT, RG, RR <br>
	4: X, Y, Z, LT, RG, RR<br>
	5: VX, VY, VZ<br>
	6: LT, RG, RR<br>
	<br>
      X      X-component of position vector (km)    <br>                           
      Y      Y-component of position vector (km)    <br>                           
      Z      Z-component of position vector (km)                               
      VX     X-component of velocity vector (km/sec)  <br>                         
      VY     Y-component of velocity vector (km/sec)   <br>                        
      VZ     Z-component of velocity vector (km/sec)  <br>                         
      LT     One-way down-leg Newtonian light-time (sec) <br>                      
      RG     Range; distance from coordinate center (km) <br>                      
      RR     Range-rate; radial velocity wrt coord. center (km/sec)   <br>
<br>
<hr>
<br>
Italian excel table:<br>
<textarea id="excel1" name="excel1" cols="100" rows="10">2456145,715277778
	2012-Aug-06 05:10:00	 -3,455085966964567E+01	  3,742850180366905E+03	  
9,929739841539686E+00	 -5,070789692409010E+00	 -2,318796529540720E+00	  
2,119737619558741E+00	  1,248538020404999E-02	  3,743022820436686E+03	 
-2,266259071769363E+00	
2456145,715972222	2012-Aug-06 05:11:00	 -3,385873588858247E+02	  
3,598080208310155E+03	  1,370347824852299E+02	 -5,060962542410576E+00	 
-2,508888164498984E+00	  2,115933131034113E+00	  1,206358939768339E-02	 
 3,616573117834244E+03	 -1,942072299849976E+00	
2456145,716666667	2012-Aug-06 05:12:00	 -6,415006428665663E+02	  
3,441569268172471E+03	  2,636898081834424E+02	 -5,032837588072186E+00	 
-2,709634463292384E+00	  2,104521854593768E+00	  1,171064368357691E-02	 
 3,510762654661695E+03	 -1,578541681575192E+00	
2456145,717361111	2012-Aug-06 05:13:00	 -9,397175034351607E+02	  
3,274541534744889E+03	  3,875477218134379E+02	 -4,637534289042591E+00	 
-2,655874850996921E+00	  1,818684760402614E+00	  1,143686387607644E-02	 
 3,428685533220364E+03	 -1,059873585862430E+00	
2456145,718055556	2012-Aug-06 05:14:00	 -1,095902086630319E+03	  
3,196484076330947E+03	  4,495628794999734E+02	 -1,339814050794620E+00	 
-5,325583189880350E-01	  4,594439720849413E-01	  1,137087593585076E-02	 
 3,408902846421749E+03	 -8,055441465514249E-03	
2456145,718750000	2012-Aug-06 05:15:00	 -1,154496369097686E+03	  
3,172159462601117E+03	  4,720962326762456E+02	 -7,481521114212187E-01	 
-3,499224257690184E-01	  2,973256144563240E-01	  1,136975732751931E-02	 
 3,408567496080524E+03	 -3,107010072992896E-02	
2456145,719444444	2012-Aug-06 05:16:00	 -1,191616437933203E+03	  
3,150992925685514E+03	  4,870292707079873E+02	 -5,031436685524366E-01	 
-3,645128831226998E-01	  2,021159323854356E-01	  1,135387879119416E-02	 
 3,403807230646166E+03	 -1,323773187702166E-01	
2456145,720138889	2012-Aug-06 05:17:00	 -1,208884268646485E+03	  
3,136747292586391E+03	  4,950063581916481E+02	 -1,907243921818244E-01	 
-1,852810795485615E-01	  9,180297551385407E-02	  1,133412120195803E-02	 
 3,397884054404911E+03	 -8,981270279360377E-02	
2456145,720833333	2012-Aug-06 05:18:00	 -1,219497143673446E+03	  
3,126288788898814E+03	  5,000714729018823E+02	 -1,720081758911693E-01	 
-1,673134410923747E-01	  7,764705139250178E-02	  1,131708127209950E-02	 
 3,392775611948477E+03	 -8,090059938194472E-02	
2456145,721527778	2012-Aug-06 05:19:00	 -1,231174617482220E+03	  
3,119071553046490E+03	  5,054780426044879E+02	 -1,994762660497914E-01	 
-9,393540041977001E-02	  9,377487834072738E-02	  1,131166275907173E-02	 
 3,391151182609174E+03	  6,554246960983297E-09	
</textarea><br>
<button id="btnTable1" name="btnTable1" onclick="tableSelect('excel1')">Copy to clipboard</button><br>
<br>
English table:<br>
<textarea id="excel2" name="excel2" cols="100" rows="10">(tabella)</textarea><br>

	<svg id="js-plotly-tester" xmlns="https://www.w3.org/2000/svg" xlink="https://www.w3.org/1999/xlink" style="position: absolute; left: -10000px; top: -10000px; width: 9000px; height: 9000px; z-index: 1;"><path class="js-reference-point" d="M0,0H1V1H0Z" style="stroke-width: 0px; fill: black;"></path></svg></body></html>
